{
    "sourceFile": "src/app/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 29,
            "patches": [
                {
                    "date": 1766786679104,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766786734037,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,94 @@\n+\"use client\";\n+\n+import { useMemo, useState } from \"react\";\n+\n+type DayPlan = {\n+  day: number;\n+  title: string;\n+  items: string[];\n+};\n+\n+function buildPlaceholderItinerary(destination: string, days: number): DayPlan[] {\n+  const safeDays = Math.max(1, Math.min(14, Number.isFinite(days) ? days : 1));\n+  const city = destination.trim() || \"your destination\";\n+\n+  const templates: Array<Omit<DayPlan, \"day\">> = [\n+    {\n+      title: \"Arrive + easy explore\",\n+      items: [\n+        `Check in and take a relaxed walk around downtown ${city}.`,\n+        \"Grab a local coffee and a light meal.\",\n+        \"Sunset viewpoint or waterfront stroll.\",\n+      ],\n+    },\n+    {\n+      title: \"Top highlights\",\n+      items: [\n+        `Visit a must-see landmark in ${city}.`,\n+        \"Lunch at a highly rated spot nearby.\",\n+        \"Museum / neighborhood exploration.\",\n+      ],\n+    },\n+    {\n+      title: \"Nature + local vibes\",\n+      items: [\n+        \"Morning park/trail (easy).\",\n+        \"Local market or shopping street.\",\n+        \"Dinner + dessert spot.\",\n+      ],\n+    },\n+    {\n+      title: \"Food day\",\n+      items: [\n+        \"Breakfast/brunch crawl.\",\n+        \"Try 2–3 signature dishes.\",\n+        \"Evening: casual bar/café (optional).\",\n+      ],\n+    },\n+  ];\n+\n+  return Array.from({ length: safeDays }, (_, i) => {\n+    const t = templates[i % templates.length];\n+    return {\n+      day: i + 1,\n+      title: t.title,\n+      items: t.items,\n+    };\n+  });\n+}\n+\n export default function Home() {\n+  const [destination, setDestination] = useState(\"\");\n+  const [daysText, setDaysText] = useState(\"3\");\n+  const [itinerary, setItinerary] = useState<DayPlan[] | null>(null);\n+  const [error, setError] = useState<string | null>(null);\n+\n+  const daysNumber = useMemo(() => {\n+    const n = Number(daysText);\n+    return Number.isFinite(n) ? n : NaN;\n+  }, [daysText]);\n+\n+  const onGenerate = () => {\n+    const dest = destination.trim();\n+    const days = Math.floor(daysNumber);\n+\n+    if (!dest) {\n+      setError(\"Please enter a destination.\");\n+      setItinerary(null);\n+      return;\n+    }\n+\n+    if (!Number.isFinite(daysNumber) || days < 1 || days > 14) {\n+      setError(\"Please enter days between 1 and 14.\");\n+      setItinerary(null);\n+      return;\n+    }\n+\n+    setError(null);\n+    setItinerary(buildPlaceholderItinerary(dest, days));\n+  };\n+\n   return (\n     <main className=\"min-h-screen bg-gray-50\">\n       <header className=\"sticky top-0 border-b bg-white\">\n         <div className=\"mx-auto flex max-w-6xl items-center justify-between px-4 py-3\">\n@@ -25,19 +114,69 @@\n           <div className=\"grid gap-4 md:grid-cols-3\">\n             <input\n               className=\"rounded-md border px-3 py-2\"\n               placeholder=\"Destination (e.g., Vancouver)\"\n+              value={destination}\n+              onChange={(e) => setDestination(e.target.value)}\n             />\n             <input\n               className=\"rounded-md border px-3 py-2\"\n               placeholder=\"Days (e.g., 3)\"\n+              value={daysText}\n+              onChange={(e) => setDaysText(e.target.value)}\n+              inputMode=\"numeric\"\n             />\n-            <button className=\"rounded-md bg-black px-3 py-2 text-white\">\n+            <button\n+              className=\"rounded-md bg-black px-3 py-2 text-white\"\n+              onClick={onGenerate}\n+            >\n               Generate\n             </button>\n           </div>\n+\n+          {error ? (\n+            <p className=\"mt-3 text-sm text-red-600\">{error}</p>\n+          ) : (\n+            <p className=\"mt-3 text-sm text-gray-500\">\n+              Tip: Start with 3 days and refine after.\n+            </p>\n+          )}\n         </div>\n \n+        {/* Results (this was the missing / wrong-placement piece) */}\n+        {itinerary ? (\n+          <div className=\"mt-6 rounded-xl border bg-white p-5\">\n+            <div className=\"flex items-start justify-between gap-3\">\n+              <div>\n+                <h2 className=\"text-lg font-semibold\">Your itinerary</h2>\n+                <p className=\"mt-1 text-sm text-gray-600\">\n+                  {destination.trim()} • {itinerary.length} day(s)\n+                </p>\n+              </div>\n+              <button\n+                className=\"rounded-md border bg-white px-3 py-1.5 text-sm\"\n+                onClick={() => setItinerary(null)}\n+              >\n+                Clear\n+              </button>\n+            </div>\n+\n+            <div className=\"mt-4 grid gap-4 md:grid-cols-2\">\n+              {itinerary.map((d) => (\n+                <div key={d.day} className=\"rounded-lg border p-4\">\n+                  <div className=\"text-sm font-medium text-gray-500\">Day {d.day}</div>\n+                  <div className=\"mt-1 text-base font-semibold\">{d.title}</div>\n+                  <ul className=\"mt-2 list-disc pl-5 text-sm text-gray-700\">\n+                    {d.items.map((it, idx) => (\n+                      <li key={idx}>{it}</li>\n+                    ))}\n+                  </ul>\n+                </div>\n+              ))}\n+            </div>\n+          </div>\n+        ) : null}\n+\n         <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n           <div className=\"rounded-xl border bg-white p-5\">\n             <div className=\"text-sm font-medium text-gray-500\">Feature</div>\n             <div className=\"mt-1 text-lg font-semibold\">Itineraries</div>\n"
                },
                {
                    "date": 1766822868903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,60 +7,168 @@\n   title: string;\n   items: string[];\n };\n \n-function buildPlaceholderItinerary(destination: string, days: number): DayPlan[] {\n-  const safeDays = Math.max(1, Math.min(14, Number.isFinite(days) ? days : 1));\n+const APP_NAME = \"Wander App\";\n+const MIN_DAYS = 1;\n+const MAX_DAYS = 14;\n+\n+const TRAVEL_STYLES = [\n+  { key: \"relaxed\", label: \"Relaxed\" },\n+  { key: \"foodie\", label: \"Foodie\" },\n+  { key: \"adventure\", label: \"Adventure\" },\n+  { key: \"culture\", label: \"Culture\" },\n+] as const;\n+\n+type TravelStyleKey = (typeof TRAVEL_STYLES)[number][\"key\"];\n+\n+function clampDays(n: number): number {\n+  if (!Number.isFinite(n)) return MIN_DAYS;\n+  return Math.max(MIN_DAYS, Math.min(MAX_DAYS, n));\n+}\n+\n+function buildPlaceholderItinerary(destination: string, days: number, style: TravelStyleKey): DayPlan[] {\n+  const safeDays = clampDays(days);\n   const city = destination.trim() || \"your destination\";\n \n-  const templates: Array<Omit<DayPlan, \"day\">> = [\n-    {\n-      title: \"Arrive + easy explore\",\n-      items: [\n-        `Check in and take a relaxed walk around downtown ${city}.`,\n-        \"Grab a local coffee and a light meal.\",\n-        \"Sunset viewpoint or waterfront stroll.\",\n-      ],\n-    },\n-    {\n-      title: \"Top highlights\",\n-      items: [\n-        `Visit a must-see landmark in ${city}.`,\n-        \"Lunch at a highly rated spot nearby.\",\n-        \"Museum / neighborhood exploration.\",\n-      ],\n-    },\n-    {\n-      title: \"Nature + local vibes\",\n-      items: [\n-        \"Morning park/trail (easy).\",\n-        \"Local market or shopping street.\",\n-        \"Dinner + dessert spot.\",\n-      ],\n-    },\n-    {\n-      title: \"Food day\",\n-      items: [\n-        \"Breakfast/brunch crawl.\",\n-        \"Try 2–3 signature dishes.\",\n-        \"Evening: casual bar/café (optional).\",\n-      ],\n-    },\n-  ];\n+  const byStyle: Record<TravelStyleKey, Array<Omit<DayPlan, \"day\">>> = {\n+    relaxed: [\n+      {\n+        title: \"Arrive + slow stroll\",\n+        items: [\n+          `Check in and take a relaxed walk around central ${city}.`,\n+          \"Coffee stop + people watching.\",\n+          \"Sunset viewpoint or waterfront stroll.\",\n+        ],\n+      },\n+      {\n+        title: \"Neighborhood day\",\n+        items: [\n+          \"Late breakfast/brunch.\",\n+          \"Explore a charming neighborhood at your own pace.\",\n+          \"Easy evening: cozy café or live music.\",\n+        ],\n+      },\n+    ],\n+    foodie: [\n+      {\n+        title: \"Iconic bites\",\n+        items: [\n+          `Start with a local must-try in ${city}.`,\n+          \"Lunch: top-rated spot nearby.\",\n+          \"Evening: dessert + a signature drink.\",\n+        ],\n+      },\n+      {\n+        title: \"Market + tasting\",\n+        items: [\n+          \"Morning market browse + tastings.\",\n+          \"Street food crawl (2–4 stops).\",\n+          \"Dinner reservation at a local favorite.\",\n+        ],\n+      },\n+    ],\n+    adventure: [\n+      {\n+        title: \"Outdoor kickoff\",\n+        items: [\n+          \"Early start: scenic trail / hike (easy-moderate).\",\n+          \"Picnic lunch or lookout viewpoint.\",\n+          \"Evening recovery: spa / hot tub / chill.\",\n+        ],\n+      },\n+      {\n+        title: \"Day trip energy\",\n+        items: [\n+          `Half-day trip outside ${city}.`,\n+          \"Try an activity (kayak, bike, climb — your pick).\",\n+          \"Golden hour photos + casual dinner.\",\n+        ],\n+      },\n+    ],\n+    culture: [\n+      {\n+        title: \"Landmarks + stories\",\n+        items: [\n+          `Visit a must-see landmark in ${city}.`,\n+          \"Museum / gallery time.\",\n+          \"Historic district walk + local dinner.\",\n+        ],\n+      },\n+      {\n+        title: \"Hidden gems\",\n+        items: [\n+          \"Bookstore / architecture / local craft shops.\",\n+          \"Neighborhood café + journaling.\",\n+          \"Evening: performance or cultural event.\",\n+        ],\n+      },\n+    ],\n+  };\n \n+  const templates = byStyle[style];\n+\n   return Array.from({ length: safeDays }, (_, i) => {\n     const t = templates[i % templates.length];\n-    return {\n-      day: i + 1,\n-      title: t.title,\n-      items: t.items,\n-    };\n+    return { day: i + 1, title: t.title, items: t.items };\n   });\n }\n \n+function IconSparkle(props: { className?: string }) {\n+  return (\n+    <svg\n+      className={props.className}\n+      viewBox=\"0 0 24 24\"\n+      fill=\"none\"\n+      xmlns=\"http://www.w3.org/2000/svg\"\n+      aria-hidden=\"true\"\n+    >\n+      <path\n+        d=\"M12 2l1.1 5.2L18 9l-4.9 1.8L12 16l-1.1-5.2L6 9l4.9-1.8L12 2z\"\n+        stroke=\"currentColor\"\n+        strokeWidth=\"1.5\"\n+        strokeLinejoin=\"round\"\n+      />\n+      <path\n+        d=\"M19 13l.7 3.2 3.3.8-3.3.8L19 21l-.7-3.2-3.3-.8 3.3-.8L19 13z\"\n+        stroke=\"currentColor\"\n+        strokeWidth=\"1.5\"\n+        strokeLinejoin=\"round\"\n+      />\n+    </svg>\n+  );\n+}\n+\n+function IconArrow(props: { className?: string }) {\n+  return (\n+    <svg\n+      className={props.className}\n+      viewBox=\"0 0 24 24\"\n+      fill=\"none\"\n+      xmlns=\"http://www.w3.org/2000/svg\"\n+      aria-hidden=\"true\"\n+    >\n+      <path\n+        d=\"M5 12h12\"\n+        stroke=\"currentColor\"\n+        strokeWidth=\"1.5\"\n+        strokeLinecap=\"round\"\n+      />\n+      <path\n+        d=\"M13 6l6 6-6 6\"\n+        stroke=\"currentColor\"\n+        strokeWidth=\"1.5\"\n+        strokeLinecap=\"round\"\n+        strokeLinejoin=\"round\"\n+      />\n+    </svg>\n+  );\n+}\n+\n export default function Home() {\n   const [destination, setDestination] = useState(\"\");\n   const [daysText, setDaysText] = useState(\"3\");\n+  const [style, setStyle] = useState<TravelStyleKey>(\"relaxed\");\n   const [itinerary, setItinerary] = useState<DayPlan[] | null>(null);\n   const [error, setError] = useState<string | null>(null);\n \n   const daysNumber = useMemo(() => {\n@@ -72,134 +180,277 @@\n     const dest = destination.trim();\n     const days = Math.floor(daysNumber);\n \n     if (!dest) {\n-      setError(\"Please enter a destination.\");\n+      setError(\"Enter a destination to continue.\");\n       setItinerary(null);\n       return;\n     }\n \n-    if (!Number.isFinite(daysNumber) || days < 1 || days > 14) {\n-      setError(\"Please enter days between 1 and 14.\");\n+    if (!Number.isFinite(daysNumber) || days < MIN_DAYS || days > MAX_DAYS) {\n+      setError(`Enter days between ${MIN_DAYS} and ${MAX_DAYS}.`);\n       setItinerary(null);\n       return;\n     }\n \n     setError(null);\n-    setItinerary(buildPlaceholderItinerary(dest, days));\n+    setItinerary(buildPlaceholderItinerary(dest, days, style));\n   };\n \n+  const onQuickDemo = () => {\n+    setDestination(\"Vancouver\");\n+    setDaysText(\"3\");\n+    setStyle(\"culture\");\n+    setError(null);\n+    setItinerary(buildPlaceholderItinerary(\"Vancouver\", 3, \"culture\"));\n+  };\n+\n   return (\n-    <main className=\"min-h-screen bg-gray-50\">\n-      <header className=\"sticky top-0 border-b bg-white\">\n+    <main className=\"min-h-screen bg-[#070A12] text-white\">\n+      {/* background */}\n+      <div aria-hidden=\"true\" className=\"pointer-events-none fixed inset-0 overflow-hidden\">\n+        <div className=\"absolute -top-40 left-1/2 h-[520px] w-[520px] -translate-x-1/2 rounded-full bg-gradient-to-tr from-fuchsia-500/30 via-sky-500/25 to-emerald-400/25 blur-3xl\" />\n+        <div className=\"absolute bottom-[-220px] right-[-140px] h-[520px] w-[520px] rounded-full bg-gradient-to-tr from-emerald-400/20 via-sky-500/20 to-fuchsia-500/20 blur-3xl\" />\n+        <div className=\"absolute inset-0 bg-[radial-gradient(ellipse_at_top,rgba(255,255,255,0.08),transparent_55%)]\" />\n+        <div className=\"absolute inset-0 bg-[linear-gradient(to_bottom,rgba(255,255,255,0.04)_1px,transparent_1px),linear-gradient(to_right,rgba(255,255,255,0.04)_1px,transparent_1px)] bg-[size:48px_48px] opacity-30\" />\n+      </div>\n+\n+      {/* nav */}\n+      <header className=\"sticky top-0 z-20 border-b border-white/10 bg-[#070A12]/70 backdrop-blur\">\n         <div className=\"mx-auto flex max-w-6xl items-center justify-between px-4 py-3\">\n-          <div className=\"text-lg font-semibold\">Wander App</div>\n-          <div className=\"flex gap-2\">\n-            <button className=\"rounded-md border bg-white px-3 py-1.5 text-sm\">\n-              Log in\n+          <div className=\"flex items-center gap-2\">\n+            <div className=\"grid h-9 w-9 place-items-center rounded-xl bg-white/10 ring-1 ring-white/15\">\n+              <IconSparkle className=\"h-5 w-5\" />\n+            </div>\n+            <div className=\"leading-tight\">\n+              <div className=\"text-sm font-semibold\">{APP_NAME}</div>\n+              <div className=\"text-xs text-white/60\">AI-style trip planning</div>\n+            </div>\n+          </div>\n+\n+          <div className=\"flex items-center gap-2\">\n+            <button\n+              className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/90 transition hover:bg-white/10\"\n+              onClick={onQuickDemo}\n+            >\n+              Quick demo\n             </button>\n-            <button className=\"rounded-md bg-black px-3 py-1.5 text-sm text-white\">\n-              Get started\n+            <button className=\"rounded-xl bg-white px-3 py-2 text-sm font-semibold text-black transition hover:bg-white/90\">\n+              Sign in\n             </button>\n           </div>\n         </div>\n       </header>\n \n-      <section className=\"mx-auto max-w-6xl px-4 py-10\">\n-        <h1 className=\"text-3xl font-bold tracking-tight\">Plan your trip in minutes</h1>\n-        <p className=\"mt-2 max-w-2xl text-gray-600\">\n-          Tell us where you’re going and we’ll build a day-by-day plan.\n-        </p>\n+      {/* hero */}\n+      <section className=\"mx-auto max-w-6xl px-4 pb-8 pt-10\">\n+        <div className=\"grid items-start gap-8 lg:grid-cols-2\">\n+          <div>\n+            <div className=\"inline-flex items-center gap-2 rounded-full border border-white/15 bg-white/5 px-3 py-1.5 text-xs text-white/80\">\n+              <IconSparkle className=\"h-4 w-4\" />\n+              <span>Build an itinerary in seconds</span>\n+            </div>\n \n-        <div className=\"mt-8 rounded-xl border bg-white p-5\">\n-          <div className=\"grid gap-4 md:grid-cols-3\">\n-            <input\n-              className=\"rounded-md border px-3 py-2\"\n-              placeholder=\"Destination (e.g., Vancouver)\"\n-              value={destination}\n-              onChange={(e) => setDestination(e.target.value)}\n-            />\n-            <input\n-              className=\"rounded-md border px-3 py-2\"\n-              placeholder=\"Days (e.g., 3)\"\n-              value={daysText}\n-              onChange={(e) => setDaysText(e.target.value)}\n-              inputMode=\"numeric\"\n-            />\n-            <button\n-              className=\"rounded-md bg-black px-3 py-2 text-white\"\n-              onClick={onGenerate}\n-            >\n-              Generate\n-            </button>\n-          </div>\n-\n-          {error ? (\n-            <p className=\"mt-3 text-sm text-red-600\">{error}</p>\n-          ) : (\n-            <p className=\"mt-3 text-sm text-gray-500\">\n-              Tip: Start with 3 days and refine after.\n+            <h1 className=\"mt-4 text-4xl font-semibold tracking-tight sm:text-5xl\">\n+              Plan trips that feel\n+              <span className=\"bg-gradient-to-r from-fuchsia-300 via-sky-300 to-emerald-200 bg-clip-text text-transparent\"> custom-made</span>\n+            </h1>\n+            <p className=\"mt-4 max-w-xl text-base text-white/70\">\n+              Pick a destination, number of days, and vibe. We’ll generate a clean, shareable day-by-day plan.\n             </p>\n-          )}\n-        </div>\n \n-        {/* Results (this was the missing / wrong-placement piece) */}\n-        {itinerary ? (\n-          <div className=\"mt-6 rounded-xl border bg-white p-5\">\n-            <div className=\"flex items-start justify-between gap-3\">\n-              <div>\n-                <h2 className=\"text-lg font-semibold\">Your itinerary</h2>\n-                <p className=\"mt-1 text-sm text-gray-600\">\n-                  {destination.trim()} • {itinerary.length} day(s)\n-                </p>\n+            {/* planner card */}\n+            <div className=\"mt-6 rounded-2xl border border-white/12 bg-white/5 p-4 shadow-[0_0_0_1px_rgba(255,255,255,0.06)] backdrop-blur\">\n+              <div className=\"grid gap-3 md:grid-cols-3\">\n+                <div className=\"md:col-span-2\">\n+                  <label className=\"text-xs text-white/60\">Destination</label>\n+                  <input\n+                    className=\"mt-1 w-full rounded-xl border border-white/15 bg-black/30 px-3 py-2 text-sm text-white placeholder:text-white/35 outline-none ring-0 transition focus:border-white/25\"\n+                    placeholder=\"e.g., Vancouver\"\n+                    value={destination}\n+                    onChange={(e) => setDestination(e.target.value)}\n+                  />\n+                </div>\n+                <div>\n+                  <label className=\"text-xs text-white/60\">Days</label>\n+                  <input\n+                    className=\"mt-1 w-full rounded-xl border border-white/15 bg-black/30 px-3 py-2 text-sm text-white placeholder:text-white/35 outline-none transition focus:border-white/25\"\n+                    placeholder=\"3\"\n+                    value={daysText}\n+                    onChange={(e) => setDaysText(e.target.value)}\n+                    inputMode=\"numeric\"\n+                  />\n+                </div>\n               </div>\n-              <button\n-                className=\"rounded-md border bg-white px-3 py-1.5 text-sm\"\n-                onClick={() => setItinerary(null)}\n-              >\n-                Clear\n-              </button>\n+\n+              <div className=\"mt-3\">\n+                <div className=\"flex items-center justify-between\">\n+                  <div className=\"text-xs text-white/60\">Vibe</div>\n+                  <div className=\"text-xs text-white/45\">Tap to switch</div>\n+                </div>\n+                <div className=\"mt-2 flex flex-wrap gap-2\">\n+                  {TRAVEL_STYLES.map((s) => {\n+                    const isActive = s.key === style;\n+                    return (\n+                      <button\n+                        key={s.key}\n+                        onClick={() => setStyle(s.key)}\n+                        className={\n+                          \"rounded-full px-3 py-1.5 text-sm transition \" +\n+                          (isActive\n+                            ? \"bg-white text-black\"\n+                            : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                        }\n+                      >\n+                        {s.label}\n+                      </button>\n+                    );\n+                  })}\n+                </div>\n+              </div>\n+\n+              <div className=\"mt-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n+                <div className=\"text-sm\">\n+                  {error ? (\n+                    <span className=\"text-rose-300\">{error}</span>\n+                  ) : (\n+                    <span className=\"text-white/60\">Tip: Keep it {MAX_DAYS} days max for now.</span>\n+                  )}\n+                </div>\n+\n+                <button\n+                  onClick={onGenerate}\n+                  className=\"group inline-flex items-center justify-center gap-2 rounded-xl bg-white px-4 py-2.5 text-sm font-semibold text-black transition hover:bg-white/90\"\n+                >\n+                  Generate\n+                  <IconArrow className=\"h-4 w-4 transition group-hover:translate-x-0.5\" />\n+                </button>\n+              </div>\n             </div>\n \n-            <div className=\"mt-4 grid gap-4 md:grid-cols-2\">\n-              {itinerary.map((d) => (\n-                <div key={d.day} className=\"rounded-lg border p-4\">\n-                  <div className=\"text-sm font-medium text-gray-500\">Day {d.day}</div>\n-                  <div className=\"mt-1 text-base font-semibold\">{d.title}</div>\n-                  <ul className=\"mt-2 list-disc pl-5 text-sm text-gray-700\">\n-                    {d.items.map((it, idx) => (\n-                      <li key={idx}>{it}</li>\n-                    ))}\n-                  </ul>\n+            <div className=\"mt-6 grid gap-3 sm:grid-cols-3\">\n+              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n+                <div className=\"text-xs text-white/55\">Output</div>\n+                <div className=\"mt-1 text-sm font-semibold\">Day-by-day plan</div>\n+                <div className=\"mt-1 text-sm text-white/65\">Clear structure, easy to tweak.</div>\n+              </div>\n+              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n+                <div className=\"text-xs text-white/55\">Style</div>\n+                <div className=\"mt-1 text-sm font-semibold\">Vibe presets</div>\n+                <div className=\"mt-1 text-sm text-white/65\">Relaxed, foodie, adventure, culture.</div>\n+              </div>\n+              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n+                <div className=\"text-xs text-white/55\">Share</div>\n+                <div className=\"mt-1 text-sm font-semibold\">Link-ready</div>\n+                <div className=\"mt-1 text-sm text-white/65\">Great for friends & family.</div>\n+              </div>\n+            </div>\n+          </div>\n+\n+          {/* preview */}\n+          <div className=\"lg:pt-2\">\n+            <div className=\"rounded-3xl border border-white/12 bg-white/5 p-5 shadow-[0_0_0_1px_rgba(255,255,255,0.06)] backdrop-blur\">\n+              <div className=\"flex items-start justify-between gap-3\">\n+                <div>\n+                  <div className=\"text-xs text-white/60\">Preview</div>\n+                  <div className=\"mt-1 text-lg font-semibold\">Your itinerary</div>\n+                  <div className=\"mt-1 text-sm text-white/60\">\n+                    {itinerary ? (\n+                      <>\n+                        {destination.trim() || \"—\"} • {itinerary.length} day(s) • {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n+                      </>\n+                    ) : (\n+                      \"Generate to see your plan here\"\n+                    )}\n+                  </div>\n                 </div>\n-              ))}\n+                <button\n+                  className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n+                  onClick={() => setItinerary(null)}\n+                  disabled={!itinerary}\n+                >\n+                  Clear\n+                </button>\n+              </div>\n+\n+              {itinerary ? (\n+                <div className=\"mt-4 grid gap-3\">\n+                  {itinerary.slice(0, 4).map((d) => (\n+                    <div\n+                      key={d.day}\n+                      className=\"rounded-2xl border border-white/12 bg-black/20 p-4 transition hover:bg-black/25\"\n+                    >\n+                      <div className=\"flex items-center justify-between\">\n+                        <div className=\"text-sm font-semibold\">Day {d.day}</div>\n+                        <div className=\"text-xs text-white/55\">~ 4–6 hrs</div>\n+                      </div>\n+                      <div className=\"mt-1 text-sm text-white/80\">{d.title}</div>\n+                      <ul className=\"mt-2 space-y-1 text-sm text-white/65\">\n+                        {d.items.slice(0, 3).map((it, idx) => (\n+                          <li key={idx} className=\"flex gap-2\">\n+                            <span className=\"mt-2 h-1.5 w-1.5 shrink-0 rounded-full bg-white/40\" />\n+                            <span>{it}</span>\n+                          </li>\n+                        ))}\n+                      </ul>\n+                    </div>\n+                  ))}\n+                  {itinerary.length > 4 ? (\n+                    <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4 text-sm text-white/70\">\n+                      + {itinerary.length - 4} more days… (we’ll show full view on the next page)\n+                    </div>\n+                  ) : null}\n+                </div>\n+              ) : (\n+                <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n+                  <div className=\"text-sm font-semibold\">Try a sample</div>\n+                  <div className=\"mt-1 text-sm text-white/65\">\n+                    Click <span className=\"text-white\">Quick demo</span> in the top right.\n+                  </div>\n+                </div>\n+              )}\n             </div>\n+\n+            <div className=\"mt-4 grid gap-3 sm:grid-cols-2\">\n+              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n+                <div className=\"text-sm font-semibold\">How it works</div>\n+                <div className=\"mt-2 space-y-2 text-sm text-white/70\">\n+                  <div className=\"flex gap-2\">\n+                    <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">1</span>\n+                    <span>Enter destination + days</span>\n+                  </div>\n+                  <div className=\"flex gap-2\">\n+                    <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">2</span>\n+                    <span>Pick your vibe</span>\n+                  </div>\n+                  <div className=\"flex gap-2\">\n+                    <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">3</span>\n+                    <span>Generate + refine</span>\n+                  </div>\n+                </div>\n+              </div>\n+              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n+                <div className=\"text-sm font-semibold\">Coming next</div>\n+                <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n+                  <div>• Map view</div>\n+                  <div>• Save trips</div>\n+                  <div>• Shareable link</div>\n+                </div>\n+              </div>\n+            </div>\n           </div>\n-        ) : null}\n+        </div>\n+      </section>\n \n-        <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n-          <div className=\"rounded-xl border bg-white p-5\">\n-            <div className=\"text-sm font-medium text-gray-500\">Feature</div>\n-            <div className=\"mt-1 text-lg font-semibold\">Itineraries</div>\n-            <p className=\"mt-2 text-sm text-gray-600\">\n-              Create day-by-day plans in a clean dashboard.\n-            </p>\n+      <footer className=\"mx-auto max-w-6xl px-4 pb-10 pt-2 text-sm text-white/45\">\n+        <div className=\"flex flex-col gap-2 border-t border-white/10 pt-6 sm:flex-row sm:items-center sm:justify-between\">\n+          <div>© {new Date().getFullYear()} {APP_NAME}</div>\n+          <div className=\"flex gap-4\">\n+            <button className=\"hover:text-white/70\">Privacy</button>\n+            <button className=\"hover:text-white/70\">Terms</button>\n+            <button className=\"hover:text-white/70\">Contact</button>\n           </div>\n-          <div className=\"rounded-xl border bg-white p-5\">\n-            <div className=\"text-sm font-medium text-gray-500\">Feature</div>\n-            <div className=\"mt-1 text-lg font-semibold\">Saved trips</div>\n-            <p className=\"mt-2 text-sm text-gray-600\">\n-              Save and revisit plans anytime.\n-            </p>\n-          </div>\n-          <div className=\"rounded-xl border bg-white p-5\">\n-            <div className=\"text-sm font-medium text-gray-500\">Feature</div>\n-            <div className=\"mt-1 text-lg font-semibold\">Share</div>\n-            <p className=\"mt-2 text-sm text-gray-600\">\n-              Share a link with friends or family.\n-            </p>\n-          </div>\n         </div>\n-      </section>\n+      </footer>\n     </main>\n   );\n }\n"
                },
                {
                    "date": 1766823297923,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -279,9 +279,9 @@\n                     onChange={(e) => setDaysText(e.target.value)}\n                     inputMode=\"numeric\"\n                   />\n                 </div>\n-              </div>\n+              </div> \n \n               <div className=\"mt-3\">\n                 <div className=\"flex items-center justify-between\">\n                   <div className=\"text-xs text-white/60\">Vibe</div>\n"
                },
                {
                    "date": 1766823539346,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -278,9 +278,9 @@\n                     value={daysText}\n                     onChange={(e) => setDaysText(e.target.value)}\n                     inputMode=\"numeric\"\n                   />\n-                </div>\n+                </div> \n               </div> \n \n               <div className=\"mt-3\">\n                 <div className=\"flex items-center justify-between\">\n"
                },
                {
                    "date": 1766823827725,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -284,9 +284,9 @@\n \n               <div className=\"mt-3\">\n                 <div className=\"flex items-center justify-between\">\n                   <div className=\"text-xs text-white/60\">Vibe</div>\n-                  <div className=\"text-xs text-white/45\">Tap to switch</div>\n+                  <div className=\"text-xs text-white/45\">Tap to switch</div> \n                 </div>\n                 <div className=\"mt-2 flex flex-wrap gap-2\">\n                   {TRAVEL_STYLES.map((s) => {\n                     const isActive = s.key === style;\n"
                },
                {
                    "date": 1766823833176,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -283,9 +283,9 @@\n               </div> \n \n               <div className=\"mt-3\">\n                 <div className=\"flex items-center justify-between\">\n-                  <div className=\"text-xs text-white/60\">Vibe</div>\n+                  <div className=\"text-xs text-white/60\">Vibes</div>\n                   <div className=\"text-xs text-white/45\">Tap to switch</div> \n                 </div>\n                 <div className=\"mt-2 flex flex-wrap gap-2\">\n                   {TRAVEL_STYLES.map((s) => {\n"
                },
                {
                    "date": 1766824962667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,18 +1,26 @@\n \"use client\";\n \n-import { useMemo, useState } from \"react\";\n+import { useState } from \"react\";\n \n-type DayPlan = {\n-  day: number;\n+type PlanItem = {\n+  type: \"stop\" | \"travel\";\n   title: string;\n-  items: string[];\n+  durationMin: number;\n+  address?: string;\n };\n \n+type PlanResponse = {\n+  destination: string;\n+  totalMinutes: number;\n+  vibe: string;\n+  items: PlanItem[];\n+};\n+\n const APP_NAME = \"Wander App\";\n-const MIN_DAYS = 1;\n-const MAX_DAYS = 14;\n \n+type DurationKey = 120 | 150 | 180;\n+\n const TRAVEL_STYLES = [\n   { key: \"relaxed\", label: \"Relaxed\" },\n   { key: \"foodie\", label: \"Foodie\" },\n   { key: \"adventure\", label: \"Adventure\" },\n@@ -20,100 +28,8 @@\n ] as const;\n \n type TravelStyleKey = (typeof TRAVEL_STYLES)[number][\"key\"];\n \n-function clampDays(n: number): number {\n-  if (!Number.isFinite(n)) return MIN_DAYS;\n-  return Math.max(MIN_DAYS, Math.min(MAX_DAYS, n));\n-}\n-\n-function buildPlaceholderItinerary(destination: string, days: number, style: TravelStyleKey): DayPlan[] {\n-  const safeDays = clampDays(days);\n-  const city = destination.trim() || \"your destination\";\n-\n-  const byStyle: Record<TravelStyleKey, Array<Omit<DayPlan, \"day\">>> = {\n-    relaxed: [\n-      {\n-        title: \"Arrive + slow stroll\",\n-        items: [\n-          `Check in and take a relaxed walk around central ${city}.`,\n-          \"Coffee stop + people watching.\",\n-          \"Sunset viewpoint or waterfront stroll.\",\n-        ],\n-      },\n-      {\n-        title: \"Neighborhood day\",\n-        items: [\n-          \"Late breakfast/brunch.\",\n-          \"Explore a charming neighborhood at your own pace.\",\n-          \"Easy evening: cozy café or live music.\",\n-        ],\n-      },\n-    ],\n-    foodie: [\n-      {\n-        title: \"Iconic bites\",\n-        items: [\n-          `Start with a local must-try in ${city}.`,\n-          \"Lunch: top-rated spot nearby.\",\n-          \"Evening: dessert + a signature drink.\",\n-        ],\n-      },\n-      {\n-        title: \"Market + tasting\",\n-        items: [\n-          \"Morning market browse + tastings.\",\n-          \"Street food crawl (2–4 stops).\",\n-          \"Dinner reservation at a local favorite.\",\n-        ],\n-      },\n-    ],\n-    adventure: [\n-      {\n-        title: \"Outdoor kickoff\",\n-        items: [\n-          \"Early start: scenic trail / hike (easy-moderate).\",\n-          \"Picnic lunch or lookout viewpoint.\",\n-          \"Evening recovery: spa / hot tub / chill.\",\n-        ],\n-      },\n-      {\n-        title: \"Day trip energy\",\n-        items: [\n-          `Half-day trip outside ${city}.`,\n-          \"Try an activity (kayak, bike, climb — your pick).\",\n-          \"Golden hour photos + casual dinner.\",\n-        ],\n-      },\n-    ],\n-    culture: [\n-      {\n-        title: \"Landmarks + stories\",\n-        items: [\n-          `Visit a must-see landmark in ${city}.`,\n-          \"Museum / gallery time.\",\n-          \"Historic district walk + local dinner.\",\n-        ],\n-      },\n-      {\n-        title: \"Hidden gems\",\n-        items: [\n-          \"Bookstore / architecture / local craft shops.\",\n-          \"Neighborhood café + journaling.\",\n-          \"Evening: performance or cultural event.\",\n-        ],\n-      },\n-    ],\n-  };\n-\n-  const templates = byStyle[style];\n-\n-  return Array.from({ length: safeDays }, (_, i) => {\n-    const t = templates[i % templates.length];\n-    return { day: i + 1, title: t.title, items: t.items };\n-  });\n-}\n-\n function IconSparkle(props: { className?: string }) {\n   return (\n     <svg\n       className={props.className}\n@@ -165,44 +81,60 @@\n }\n \n export default function Home() {\n   const [destination, setDestination] = useState(\"\");\n-  const [daysText, setDaysText] = useState(\"3\");\n   const [style, setStyle] = useState<TravelStyleKey>(\"relaxed\");\n-  const [itinerary, setItinerary] = useState<DayPlan[] | null>(null);\n+  const [duration, setDuration] = useState<DurationKey>(150);\n+  const [plan, setPlan] = useState<PlanResponse | null>(null);\n   const [error, setError] = useState<string | null>(null);\n+  const [loading, setLoading] = useState(false);\n \n-  const daysNumber = useMemo(() => {\n-    const n = Number(daysText);\n-    return Number.isFinite(n) ? n : NaN;\n-  }, [daysText]);\n-\n-  const onGenerate = () => {\n+  const onGenerate = async () => {\n     const dest = destination.trim();\n-    const days = Math.floor(daysNumber);\n \n     if (!dest) {\n       setError(\"Enter a destination to continue.\");\n-      setItinerary(null);\n+      setPlan(null);\n       return;\n     }\n \n-    if (!Number.isFinite(daysNumber) || days < MIN_DAYS || days > MAX_DAYS) {\n-      setError(`Enter days between ${MIN_DAYS} and ${MAX_DAYS}.`);\n-      setItinerary(null);\n-      return;\n+    setError(null);\n+    setLoading(true);\n+\n+    try {\n+      // ✅ This was missing before: call your API route\n+      const res = await fetch(\"/api/itinerary\", {\n+        method: \"POST\",\n+        headers: { \"Content-Type\": \"application/json\" },\n+        body: JSON.stringify({ destination: dest, totalMinutes: duration, vibe: style }),\n+      });\n+\n+      if (!res.ok) {\n+        const txt = await res.text().catch(() => \"\");\n+        throw new Error(txt || \"Itinerary API failed\");\n+      }\n+\n+      const data = (await res.json()) as PlanResponse;\n+      setPlan(data);\n+    } catch {\n+      setError(\"Could not generate itinerary. Make sure /api/itinerary exists and restart the dev server.\");\n+      setPlan(null);\n+    } finally {\n+      setLoading(false);\n     }\n-\n-    setError(null);\n-    setItinerary(buildPlaceholderItinerary(dest, days, style));\n   };\n \n   const onQuickDemo = () => {\n     setDestination(\"Vancouver\");\n-    setDaysText(\"3\");\n     setStyle(\"culture\");\n+    setDuration(150);\n     setError(null);\n-    setItinerary(buildPlaceholderItinerary(\"Vancouver\", 3, \"culture\"));\n+    setPlan(null);\n+\n+    // run after state updates\n+    setTimeout(() => {\n+      void onGenerate();\n+    }, 0);\n   };\n \n   return (\n     <main className=\"min-h-screen bg-[#070A12] text-white\">\n@@ -222,20 +154,21 @@\n               <IconSparkle className=\"h-5 w-5\" />\n             </div>\n             <div className=\"leading-tight\">\n               <div className=\"text-sm font-semibold\">{APP_NAME}</div>\n-              <div className=\"text-xs text-white/60\">AI-style trip planning</div>\n+              <div className=\"text-xs text-white/60\">2–3 hour itinerary builder</div>\n             </div>\n           </div>\n \n           <div className=\"flex items-center gap-2\">\n             <button\n               className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/90 transition hover:bg-white/10\"\n               onClick={onQuickDemo}\n+              type=\"button\"\n             >\n               Quick demo\n             </button>\n-            <button className=\"rounded-xl bg-white px-3 py-2 text-sm font-semibold text-black transition hover:bg-white/90\">\n+            <button className=\"rounded-xl bg-white px-3 py-2 text-sm font-semibold text-black transition hover:bg-white/90\" type=\"button\">\n               Sign in\n             </button>\n           </div>\n         </div>\n@@ -246,17 +179,18 @@\n         <div className=\"grid items-start gap-8 lg:grid-cols-2\">\n           <div>\n             <div className=\"inline-flex items-center gap-2 rounded-full border border-white/15 bg-white/5 px-3 py-1.5 text-xs text-white/80\">\n               <IconSparkle className=\"h-4 w-4\" />\n-              <span>Build an itinerary in seconds</span>\n+              <span>Short, realistic plans</span>\n             </div>\n \n             <h1 className=\"mt-4 text-4xl font-semibold tracking-tight sm:text-5xl\">\n-              Plan trips that feel\n-              <span className=\"bg-gradient-to-r from-fuchsia-300 via-sky-300 to-emerald-200 bg-clip-text text-transparent\"> custom-made</span>\n+              Build a\n+              <span className=\"bg-gradient-to-r from-fuchsia-300 via-sky-300 to-emerald-200 bg-clip-text text-transparent\"> 2–3 hour</span>\n+              {\" \"}itinerary\n             </h1>\n             <p className=\"mt-4 max-w-xl text-base text-white/70\">\n-              Pick a destination, number of days, and vibe. We’ll generate a clean, shareable day-by-day plan.\n+              Pick a destination, duration, and vibe. We’ll generate a tight plan you can actually follow.\n             </p>\n \n             {/* planner card */}\n             <div className=\"mt-6 rounded-2xl border border-white/12 bg-white/5 p-4 shadow-[0_0_0_1px_rgba(255,255,255,0.06)] backdrop-blur\">\n@@ -269,31 +203,46 @@\n                     value={destination}\n                     onChange={(e) => setDestination(e.target.value)}\n                   />\n                 </div>\n+\n                 <div>\n-                  <label className=\"text-xs text-white/60\">Days</label>\n-                  <input\n-                    className=\"mt-1 w-full rounded-xl border border-white/15 bg-black/30 px-3 py-2 text-sm text-white placeholder:text-white/35 outline-none transition focus:border-white/25\"\n-                    placeholder=\"3\"\n-                    value={daysText}\n-                    onChange={(e) => setDaysText(e.target.value)}\n-                    inputMode=\"numeric\"\n-                  />\n-                </div> \n-              </div> \n+                  <label className=\"text-xs text-white/60\">Duration</label>\n+                  <div className=\"mt-1 grid grid-cols-3 gap-2\">\n+                    {([120, 150, 180] as const).map((m) => {\n+                      const active = m === duration;\n+                      return (\n+                        <button\n+                          key={m}\n+                          type=\"button\"\n+                          onClick={() => setDuration(m)}\n+                          className={\n+                            \"rounded-xl px-3 py-2 text-sm transition \" +\n+                            (active\n+                              ? \"bg-white text-black\"\n+                              : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                          }\n+                        >\n+                          {m === 120 ? \"2h\" : m === 150 ? \"2.5h\" : \"3h\"}\n+                        </button>\n+                      );\n+                    })}\n+                  </div>\n+                </div>\n+              </div>\n \n               <div className=\"mt-3\">\n                 <div className=\"flex items-center justify-between\">\n-                  <div className=\"text-xs text-white/60\">Vibes</div>\n-                  <div className=\"text-xs text-white/45\">Tap to switch</div> \n+                  <div className=\"text-xs text-white/60\">Vibe</div>\n+                  <div className=\"text-xs text-white/45\">Tap to switch</div>\n                 </div>\n                 <div className=\"mt-2 flex flex-wrap gap-2\">\n                   {TRAVEL_STYLES.map((s) => {\n                     const isActive = s.key === style;\n                     return (\n                       <button\n                         key={s.key}\n+                        type=\"button\"\n                         onClick={() => setStyle(s.key)}\n                         className={\n                           \"rounded-full px-3 py-1.5 text-sm transition \" +\n                           (isActive\n@@ -312,37 +261,39 @@\n                 <div className=\"text-sm\">\n                   {error ? (\n                     <span className=\"text-rose-300\">{error}</span>\n                   ) : (\n-                    <span className=\"text-white/60\">Tip: Keep it {MAX_DAYS} days max for now.</span>\n+                    <span className=\"text-white/60\">We’ll keep it within {duration} minutes.</span>\n                   )}\n                 </div>\n \n                 <button\n                   onClick={onGenerate}\n-                  className=\"group inline-flex items-center justify-center gap-2 rounded-xl bg-white px-4 py-2.5 text-sm font-semibold text-black transition hover:bg-white/90\"\n+                  disabled={loading}\n+                  className=\"group inline-flex items-center justify-center gap-2 rounded-xl bg-white px-4 py-2.5 text-sm font-semibold text-black transition hover:bg-white/90 disabled:opacity-60\"\n+                  type=\"button\"\n                 >\n-                  Generate\n+                  {loading ? \"Generating…\" : \"Generate\"}\n                   <IconArrow className=\"h-4 w-4 transition group-hover:translate-x-0.5\" />\n                 </button>\n               </div>\n             </div>\n \n             <div className=\"mt-6 grid gap-3 sm:grid-cols-3\">\n               <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-xs text-white/55\">Output</div>\n-                <div className=\"mt-1 text-sm font-semibold\">Day-by-day plan</div>\n-                <div className=\"mt-1 text-sm text-white/65\">Clear structure, easy to tweak.</div>\n+                <div className=\"text-xs text-white/55\">Format</div>\n+                <div className=\"mt-1 text-sm font-semibold\">Stops + travel</div>\n+                <div className=\"mt-1 text-sm text-white/65\">2–3 stops with realistic timing.</div>\n               </div>\n               <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-xs text-white/55\">Style</div>\n-                <div className=\"mt-1 text-sm font-semibold\">Vibe presets</div>\n-                <div className=\"mt-1 text-sm text-white/65\">Relaxed, foodie, adventure, culture.</div>\n+                <div className=\"text-xs text-white/55\">Routing</div>\n+                <div className=\"mt-1 text-sm font-semibold\">API-backed</div>\n+                <div className=\"mt-1 text-sm text-white/65\">Uses /api/itinerary in your app.</div>\n               </div>\n               <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-xs text-white/55\">Share</div>\n-                <div className=\"mt-1 text-sm font-semibold\">Link-ready</div>\n-                <div className=\"mt-1 text-sm text-white/65\">Great for friends & family.</div>\n+                <div className=\"text-xs text-white/55\">Next</div>\n+                <div className=\"mt-1 text-sm font-semibold\">Map view</div>\n+                <div className=\"mt-1 text-sm text-white/65\">Plot stops on a map.</div>\n               </div>\n             </div>\n           </div>\n \n@@ -353,60 +304,50 @@\n                 <div>\n                   <div className=\"text-xs text-white/60\">Preview</div>\n                   <div className=\"mt-1 text-lg font-semibold\">Your itinerary</div>\n                   <div className=\"mt-1 text-sm text-white/60\">\n-                    {itinerary ? (\n+                    {plan ? (\n                       <>\n-                        {destination.trim() || \"—\"} • {itinerary.length} day(s) • {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n+                        {plan.destination || \"—\"} • {plan.totalMinutes} min • {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n                       </>\n                     ) : (\n                       \"Generate to see your plan here\"\n                     )}\n                   </div>\n                 </div>\n                 <button\n                   className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n-                  onClick={() => setItinerary(null)}\n-                  disabled={!itinerary}\n+                  onClick={() => setPlan(null)}\n+                  disabled={!plan}\n+                  type=\"button\"\n                 >\n                   Clear\n                 </button>\n               </div>\n \n-              {itinerary ? (\n+              {plan ? (\n                 <div className=\"mt-4 grid gap-3\">\n-                  {itinerary.slice(0, 4).map((d) => (\n+                  {plan.items.map((it, idx) => (\n                     <div\n-                      key={d.day}\n-                      className=\"rounded-2xl border border-white/12 bg-black/20 p-4 transition hover:bg-black/25\"\n+                      key={idx}\n+                      className={\n+                        \"rounded-2xl border border-white/12 p-4 transition \" +\n+                        (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n+                      }\n                     >\n-                      <div className=\"flex items-center justify-between\">\n-                        <div className=\"text-sm font-semibold\">Day {d.day}</div>\n-                        <div className=\"text-xs text-white/55\">~ 4–6 hrs</div>\n+                      <div className=\"flex items-center justify-between gap-3\">\n+                        <div className=\"text-sm font-semibold\">{it.type === \"stop\" ? \"Stop\" : \"Travel\"}</div>\n+                        <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                       </div>\n-                      <div className=\"mt-1 text-sm text-white/80\">{d.title}</div>\n-                      <ul className=\"mt-2 space-y-1 text-sm text-white/65\">\n-                        {d.items.slice(0, 3).map((it, idx) => (\n-                          <li key={idx} className=\"flex gap-2\">\n-                            <span className=\"mt-2 h-1.5 w-1.5 shrink-0 rounded-full bg-white/40\" />\n-                            <span>{it}</span>\n-                          </li>\n-                        ))}\n-                      </ul>\n+                      <div className=\"mt-1 text-sm text-white/80\">{it.title}</div>\n+                      {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n                     </div>\n                   ))}\n-                  {itinerary.length > 4 ? (\n-                    <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4 text-sm text-white/70\">\n-                      + {itinerary.length - 4} more days… (we’ll show full view on the next page)\n-                    </div>\n-                  ) : null}\n                 </div>\n               ) : (\n                 <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n                   <div className=\"text-sm font-semibold\">Try a sample</div>\n-                  <div className=\"mt-1 text-sm text-white/65\">\n-                    Click <span className=\"text-white\">Quick demo</span> in the top right.\n-                  </div>\n+                  <div className=\"mt-1 text-sm text-white/65\">Click <span className=\"text-white\">Quick demo</span> in the top right.</div>\n                 </div>\n               )}\n             </div>\n \n@@ -415,26 +356,26 @@\n                 <div className=\"text-sm font-semibold\">How it works</div>\n                 <div className=\"mt-2 space-y-2 text-sm text-white/70\">\n                   <div className=\"flex gap-2\">\n                     <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">1</span>\n-                    <span>Enter destination + days</span>\n+                    <span>Destination + duration</span>\n                   </div>\n                   <div className=\"flex gap-2\">\n                     <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">2</span>\n                     <span>Pick your vibe</span>\n                   </div>\n                   <div className=\"flex gap-2\">\n                     <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">3</span>\n-                    <span>Generate + refine</span>\n+                    <span>Generate a 2–3 hour plan</span>\n                   </div>\n                 </div>\n               </div>\n               <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-sm font-semibold\">Coming next</div>\n+                <div className=\"text-sm font-semibold\">Next upgrades</div>\n                 <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n-                  <div>• Map view</div>\n-                  <div>• Save trips</div>\n-                  <div>• Shareable link</div>\n+                  <div>• Google Places for real POIs</div>\n+                  <div>• Map + pins</div>\n+                  <div>• Save & share</div>\n                 </div>\n               </div>\n             </div>\n           </div>\n@@ -444,11 +385,11 @@\n       <footer className=\"mx-auto max-w-6xl px-4 pb-10 pt-2 text-sm text-white/45\">\n         <div className=\"flex flex-col gap-2 border-t border-white/10 pt-6 sm:flex-row sm:items-center sm:justify-between\">\n           <div>© {new Date().getFullYear()} {APP_NAME}</div>\n           <div className=\"flex gap-4\">\n-            <button className=\"hover:text-white/70\">Privacy</button>\n-            <button className=\"hover:text-white/70\">Terms</button>\n-            <button className=\"hover:text-white/70\">Contact</button>\n+            <button className=\"hover:text-white/70\" type=\"button\">Privacy</button>\n+            <button className=\"hover:text-white/70\" type=\"button\">Terms</button>\n+            <button className=\"hover:text-white/70\" type=\"button\">Contact</button>\n           </div>\n         </div>\n       </footer>\n     </main>\n"
                },
                {
                    "date": 1766827334694,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,8 +6,23 @@\n   type: \"stop\" | \"travel\";\n   title: string;\n   durationMin: number;\n   address?: string;\n+\n+  // Enriched fields (present for type === \"stop\")\n+  photoUrl?: string;\n+  rating?: number;\n+  userRatingCount?: number;\n+  priceLevel?: string;\n+  openNow?: boolean;\n+  weekdayText?: string[];\n+  reviewSnippet?: string;\n+  mapsUri?: string;\n+  parking?: {\n+    name: string;\n+    address?: string;\n+    mapsUri?: string;\n+  };\n };\n \n type PlanResponse = {\n   destination: string;\n@@ -28,8 +43,26 @@\n ] as const;\n \n type TravelStyleKey = (typeof TRAVEL_STYLES)[number][\"key\"];\n \n+function formatPriceLevel(priceLevel?: string) {\n+  // Typical values: PRICE_LEVEL_FREE, PRICE_LEVEL_INEXPENSIVE, ...\n+  if (!priceLevel) return undefined;\n+  if (priceLevel.includes(\"FREE\")) return \"Free\";\n+  if (priceLevel.includes(\"INEXPENSIVE\")) return \"$\";\n+  if (priceLevel.includes(\"MODERATE\")) return \"$$\";\n+  if (priceLevel.includes(\"EXPENSIVE\")) return \"$$$\";\n+  if (priceLevel.includes(\"VERY_EXPENSIVE\")) return \"$$$$\";\n+  return priceLevel.replace(\"PRICE_LEVEL_\", \"\").toLowerCase();\n+}\n+\n+function formatRating(rating?: number, count?: number) {\n+  if (typeof rating !== \"number\") return undefined;\n+  const r = rating.toFixed(1);\n+  const c = typeof count === \"number\" ? ` (${count.toLocaleString()})` : \"\";\n+  return `${r}★${c}`;\n+}\n+\n function IconSparkle(props: { className?: string }) {\n   return (\n     <svg\n       className={props.className}\n@@ -337,10 +370,87 @@\n                       <div className=\"flex items-center justify-between gap-3\">\n                         <div className=\"text-sm font-semibold\">{it.type === \"stop\" ? \"Stop\" : \"Travel\"}</div>\n                         <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                       </div>\n-                      <div className=\"mt-1 text-sm text-white/80\">{it.title}</div>\n-                      {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n+\n+                      <div className=\"mt-2 flex gap-3\">\n+                        {it.type === \"stop\" && it.photoUrl ? (\n+                          <img\n+                            src={it.photoUrl}\n+                            alt={it.title}\n+                            className=\"h-16 w-16 rounded-xl object-cover ring-1 ring-white/10\"\n+                            loading=\"lazy\"\n+                            referrerPolicy=\"no-referrer\"\n+                          />\n+                        ) : null}\n+\n+                        <div className=\"min-w-0 flex-1\">\n+                          <div className=\"text-sm text-white/85\">{it.title}</div>\n+                          {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n+\n+                          {it.type === \"stop\" ? (\n+                            <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n+                              {formatRating(it.rating, it.userRatingCount) ? (\n+                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                  {formatRating(it.rating, it.userRatingCount)}\n+                                </span>\n+                              ) : null}\n+\n+                              {formatPriceLevel(it.priceLevel) ? (\n+                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                  {formatPriceLevel(it.priceLevel)}\n+                                </span>\n+                              ) : null}\n+\n+                              {typeof it.openNow === \"boolean\" ? (\n+                                <span\n+                                  className={\n+                                    \"rounded-full border px-2 py-0.5 \" +\n+                                    (it.openNow\n+                                      ? \"border-emerald-400/30 bg-emerald-400/10 text-emerald-200\"\n+                                      : \"border-rose-400/30 bg-rose-400/10 text-rose-200\")\n+                                  }\n+                                >\n+                                  {it.openNow ? \"Open now\" : \"Closed\"}\n+                                </span>\n+                              ) : null}\n+\n+                              {it.mapsUri ? (\n+                                <a\n+                                  href={it.mapsUri}\n+                                  target=\"_blank\"\n+                                  rel=\"noreferrer\"\n+                                  className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n+                                >\n+                                  Maps\n+                                </a>\n+                              ) : null}\n+                            </div>\n+                          ) : null}\n+\n+                          {it.type === \"stop\" && it.reviewSnippet ? (\n+                            <div className=\"mt-2 text-xs text-white/65\">“{it.reviewSnippet}”</div>\n+                          ) : null}\n+\n+                          {it.type === \"stop\" && it.parking ? (\n+                            <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n+                              <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n+                              <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n+                              {it.parking.address ? <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div> : null}\n+                              {it.parking.mapsUri ? (\n+                                <a\n+                                  href={it.parking.mapsUri}\n+                                  target=\"_blank\"\n+                                  rel=\"noreferrer\"\n+                                  className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n+                                >\n+                                  Open parking in Maps\n+                                </a>\n+                              ) : null}\n+                            </div>\n+                          ) : null}\n+                        </div>\n+                      </div>\n                     </div>\n                   ))}\n                 </div>\n               ) : (\n"
                },
                {
                    "date": 1766828186682,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -442,9 +442,9 @@\n                                   target=\"_blank\"\n                                   rel=\"noreferrer\"\n                                   className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n                                 >\n-                                  Open parking in Maps\n+                                  Open parking in Maps..\n                                 </a>\n                               ) : null}\n                             </div>\n                           ) : null}\n"
                },
                {
                    "date": 1766828194331,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -446,9 +446,9 @@\n                                   Open parking in Maps..\n                                 </a>\n                               ) : null}\n                             </div>\n-                          ) : null}\n+                          ) : null} \n                         </div>\n                       </div>\n                     </div>\n                   ))}\n"
                },
                {
                    "date": 1766863740233,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -147,10 +147,11 @@\n       }\n \n       const data = (await res.json()) as PlanResponse;\n       setPlan(data);\n-    } catch {\n-      setError(\"Could not generate itinerary. Make sure /api/itinerary exists and restart the dev server.\");\n+    } catch (e) {\n+      const msg = e instanceof Error ? e.message : \"Could not generate itinerary.\";\n+      setError(msg);\n       setPlan(null);\n     } finally {\n       setLoading(false);\n     }\n@@ -340,8 +341,17 @@\n                   <div className=\"mt-1 text-sm text-white/60\">\n                     {plan ? (\n                       <>\n                         {plan.destination || \"—\"} • {plan.totalMinutes} min • {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n+                        {plan.items?.some((x) => x.type === \"stop\" && (x.photoUrl || x.rating || x.priceLevel || x.openNow !== undefined || x.reviewSnippet || x.parking)) ? (\n+                          <span className=\"ml-2 rounded-full border border-emerald-400/30 bg-emerald-400/10 px-2 py-0.5 text-xs text-emerald-200\">\n+                            Enriched\n+                          </span>\n+                        ) : (\n+                          <span className=\"ml-2 rounded-full border border-rose-400/30 bg-rose-400/10 px-2 py-0.5 text-xs text-rose-200\">\n+                            Basic\n+                          </span>\n+                        )}\n                       </>\n                     ) : (\n                       \"Generate to see your plan here\"\n                     )}\n"
                },
                {
                    "date": 1766865499239,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,12 +1,17 @@\n \"use client\";\n \n-import { useState } from \"react\";\n+import { useEffect, useMemo, useRef, useState } from \"react\";\n \n+import Script from \"next/script\";\n+\n type PlanItem = {\n   type: \"stop\" | \"travel\";\n   title: string;\n   durationMin: number;\n+  mode?: \"DRIVE\" | \"WALK\";\n+  lat?: number;\n+  lng?: number;\n   address?: string;\n \n   // Enriched fields (present for type === \"stop\")\n   photoUrl?: string;\n@@ -27,8 +32,9 @@\n type PlanResponse = {\n   destination: string;\n   totalMinutes: number;\n   vibe: string;\n+  parkOnce?: boolean;\n   items: PlanItem[];\n };\n \n const APP_NAME = \"Wander App\";\n@@ -61,8 +67,48 @@\n   const c = typeof count === \"number\" ? ` (${count.toLocaleString()})` : \"\";\n   return `${r}★${c}`;\n }\n \n+function estimateCostRange(items: PlanItem[]) {\n+  // very rough per-stop estimates (USD)\n+  // Free: 0-0, $: 10-25, $$: 25-60, $$$: 60-120, $$$$: 120-250\n+  const stopItems = items.filter((x) => x.type === \"stop\");\n+  if (stopItems.length === 0) return null;\n+\n+  let min = 0;\n+  let max = 0;\n+\n+  for (const it of stopItems) {\n+    const pl = it.priceLevel || \"\";\n+    if (pl.includes(\"FREE\")) {\n+      min += 0;\n+      max += 0;\n+    } else if (pl.includes(\"INEXPENSIVE\")) {\n+      min += 10;\n+      max += 25;\n+    } else if (pl.includes(\"MODERATE\")) {\n+      min += 25;\n+      max += 60;\n+    } else if (pl.includes(\"EXPENSIVE\")) {\n+      min += 60;\n+      max += 120;\n+    } else if (pl.includes(\"VERY_EXPENSIVE\")) {\n+      min += 120;\n+      max += 250;\n+    } else {\n+      // unknown: assume low-to-mid\n+      min += 10;\n+      max += 60;\n+    }\n+  }\n+\n+  // Add small buffer for transport/parking etc.\n+  min += 5;\n+  max += 20;\n+\n+  return { min, max };\n+}\n+\n function IconSparkle(props: { className?: string }) {\n   return (\n     <svg\n       className={props.className}\n@@ -112,16 +158,110 @@\n     </svg>\n   );\n }\n \n+function MapView({\n+  apiKey,\n+  stops,\n+}: {\n+  apiKey: string;\n+  stops: { title: string; lat: number; lng: number }[];\n+}) {\n+  const mapDivRef = useRef<HTMLDivElement | null>(null);\n+  const mapRef = useRef<google.maps.Map | null>(null);\n+  const markersRef = useRef<google.maps.Marker[]>([]);\n+\n+  const ready = typeof window !== \"undefined\" && (window as any).google?.maps;\n+\n+  useEffect(() => {\n+    if (!ready) return;\n+    if (!mapDivRef.current) return;\n+    if (mapRef.current) return;\n+\n+    const first = stops?.[0];\n+    const center = first ? { lat: first.lat, lng: first.lng } : { lat: 49.2827, lng: -123.1207 };\n+\n+    mapRef.current = new google.maps.Map(mapDivRef.current, {\n+      center,\n+      zoom: 12,\n+      mapTypeControl: false,\n+      fullscreenControl: false,\n+      streetViewControl: false,\n+    });\n+  }, [ready, stops]);\n+\n+  useEffect(() => {\n+    if (!ready) return;\n+    if (!mapRef.current) return;\n+\n+    markersRef.current.forEach((m) => m.setMap(null));\n+    markersRef.current = [];\n+\n+    if (!stops || stops.length === 0) return;\n+\n+    const bounds = new google.maps.LatLngBounds();\n+\n+    stops.forEach((s, idx) => {\n+      const pos = { lat: s.lat, lng: s.lng };\n+      bounds.extend(pos);\n+\n+      const marker = new google.maps.Marker({\n+        map: mapRef.current!,\n+        position: pos,\n+        title: s.title,\n+        label: {\n+          text: String(idx + 1),\n+          color: \"#ffffff\",\n+          fontWeight: \"600\",\n+        },\n+      });\n+\n+      const info = new google.maps.InfoWindow({\n+        content: `<div style=\\\"font-size:13px; font-weight:600; padding:2px 0;\\\">${s.title}</div>`,\n+      });\n+\n+      marker.addListener(\"click\", () => info.open({ map: mapRef.current!, anchor: marker }));\n+\n+      markersRef.current.push(marker);\n+    });\n+\n+    mapRef.current.fitBounds(bounds, 80);\n+  }, [ready, stops]);\n+\n+  return (\n+    <div className=\"mt-4 overflow-hidden rounded-2xl border border-white/10 bg-black/20\">\n+      <div className=\"flex items-center justify-between border-b border-white/10 px-4 py-3\">\n+        <div className=\"text-sm font-semibold text-white/85\">Map</div>\n+        <div className=\"text-xs text-white/55\">Stops: {stops.length}</div>\n+      </div>\n+      <div ref={mapDivRef} className=\"h-[360px] w-full\" />\n+      <Script id=\"google-maps-js\" src={`https://maps.googleapis.com/maps/api/js?key=${apiKey}`} strategy=\"afterInteractive\" />\n+    </div>\n+  );\n+}\n+\n export default function Home() {\n   const [destination, setDestination] = useState(\"\");\n   const [style, setStyle] = useState<TravelStyleKey>(\"relaxed\");\n   const [duration, setDuration] = useState<DurationKey>(150);\n   const [plan, setPlan] = useState<PlanResponse | null>(null);\n   const [error, setError] = useState<string | null>(null);\n   const [loading, setLoading] = useState(false);\n \n+  const [parkOnce, setParkOnce] = useState(false);\n+  const [showMap, setShowMap] = useState(true);\n+\n+  const mapsKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || \"\";\n+\n+  const mapStops = useMemo(() => {\n+    if (!plan) return [] as { title: string; lat: number; lng: number }[];\n+    return plan.items\n+      .filter((it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\")\n+      .map((it) => ({ title: it.title, lat: it.lat as number, lng: it.lng as number }));\n+  }, [plan]);\n+\n+  const cost = useMemo(() => (plan ? estimateCostRange(plan.items) : null), [plan]);\n+\n   const onGenerate = async () => {\n     const dest = destination.trim();\n \n     if (!dest) {\n@@ -137,9 +277,9 @@\n       // ✅ This was missing before: call your API route\n       const res = await fetch(\"/api/itinerary\", {\n         method: \"POST\",\n         headers: { \"Content-Type\": \"application/json\" },\n-        body: JSON.stringify({ destination: dest, totalMinutes: duration, vibe: style }),\n+        body: JSON.stringify({ destination: dest, totalMinutes: duration, vibe: style, parkOnce }),\n       });\n \n       if (!res.ok) {\n         const txt = await res.text().catch(() => \"\");\n@@ -290,8 +430,24 @@\n                   })}\n                 </div>\n               </div>\n \n+            <div className=\"mt-3 flex flex-wrap items-center gap-2\">\n+              <button\n+                type=\"button\"\n+                onClick={() => setParkOnce((v) => !v)}\n+                className={\n+                  \"rounded-full px-3 py-1.5 text-sm transition \" +\n+                  (parkOnce\n+                    ? \"bg-white text-black\"\n+                    : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                }\n+              >\n+                {parkOnce ? \"Park once: ON\" : \"Park once\"}\n+              </button>\n+              <div className=\"text-xs text-white/55\">Park near the first stop, then walk between stops.</div>\n+            </div>\n+\n               <div className=\"mt-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n                 <div className=\"text-sm\">\n                   {error ? (\n                     <span className=\"text-rose-300\">{error}</span>\n@@ -350,16 +506,29 @@\n                           <span className=\"ml-2 rounded-full border border-rose-400/30 bg-rose-400/10 px-2 py-0.5 text-xs text-rose-200\">\n                             Basic\n                           </span>\n                         )}\n+                        {cost ? (\n+                          <span className=\"ml-2 rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-xs text-white/80\">\n+                            Est. ${cost.min}–${cost.max}\n+                          </span>\n+                        ) : null}\n                       </>\n                     ) : (\n                       \"Generate to see your plan here\"\n                     )}\n                   </div>\n                 </div>\n                 <button\n                   className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n+                  onClick={() => setShowMap((v) => !v)}\n+                  disabled={!plan}\n+                  type=\"button\"\n+                >\n+                  {showMap ? \"Hide map\" : \"Show map\"}\n+                </button>\n+                <button\n+                  className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n                   onClick={() => setPlan(null)}\n                   disabled={!plan}\n                   type=\"button\"\n                 >\n@@ -377,9 +546,11 @@\n                         (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n                       }\n                     >\n                       <div className=\"flex items-center justify-between gap-3\">\n-                        <div className=\"text-sm font-semibold\">{it.type === \"stop\" ? \"Stop\" : \"Travel\"}</div>\n+                        <div className=\"text-sm font-semibold\">\n+                          {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n+                        </div>\n                         <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                       </div>\n \n                       <div className=\"mt-2 flex gap-3\">\n@@ -456,14 +627,27 @@\n                                   Open parking in Maps..\n                                 </a>\n                               ) : null}\n                             </div>\n-                          ) : null} \n+                          ) : null}\n                         </div>\n                       </div>\n                     </div>\n                   ))}\n                 </div>\n+                  {showMap ? (\n+                    mapsKey ? (\n+                      <MapView apiKey={mapsKey} stops={mapStops} />\n+                    ) : (\n+                      <div className=\"mt-4 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n+                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n+                        <div className=\"mt-1 text-xs text-amber-100/80\">\n+                          Add it to <code>.env.local</code> and Vercel env vars, then restart.\n+                        </div>\n+                      </div>\n+                    )\n+                  ) : null}\n+                </div>\n               ) : (\n                 <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n                   <div className=\"text-sm font-semibold\">Try a sample</div>\n                   <div className=\"mt-1 text-sm text-white/65\">Click <span className=\"text-white\">Quick demo</span> in the top right.</div>\n@@ -491,11 +675,11 @@\n               </div>\n               <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n                 <div className=\"text-sm font-semibold\">Next upgrades</div>\n                 <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n-                  <div>• Google Places for real POIs</div>\n                   <div>• Map + pins</div>\n-                  <div>• Save & share</div>\n+                  <div>• Park once mode</div>\n+                  <div>• Cost estimate</div>\n                 </div>\n               </div>\n             </div>\n           </div>\n"
                },
                {
                    "date": 1766865618295,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -166,10 +166,10 @@\n   apiKey: string;\n   stops: { title: string; lat: number; lng: number }[];\n }) {\n   const mapDivRef = useRef<HTMLDivElement | null>(null);\n-  const mapRef = useRef<google.maps.Map | null>(null);\n-  const markersRef = useRef<google.maps.Marker[]>([]);\n+  const mapRef = useRef<any>(null);\n+  const markersRef = useRef<any[]>([]);\n \n   const ready = typeof window !== \"undefined\" && (window as any).google?.maps;\n \n   useEffect(() => {\n@@ -179,9 +179,10 @@\n \n     const first = stops?.[0];\n     const center = first ? { lat: first.lat, lng: first.lng } : { lat: 49.2827, lng: -123.1207 };\n \n-    mapRef.current = new google.maps.Map(mapDivRef.current, {\n+    const g = (window as any).google;\n+    mapRef.current = new g.maps.Map(mapDivRef.current, {\n       center,\n       zoom: 12,\n       mapTypeControl: false,\n       fullscreenControl: false,\n@@ -197,15 +198,16 @@\n     markersRef.current = [];\n \n     if (!stops || stops.length === 0) return;\n \n-    const bounds = new google.maps.LatLngBounds();\n+    const g = (window as any).google;\n+    const bounds = new g.maps.LatLngBounds();\n \n     stops.forEach((s, idx) => {\n       const pos = { lat: s.lat, lng: s.lng };\n       bounds.extend(pos);\n \n-      const marker = new google.maps.Marker({\n+      const marker = new g.maps.Marker({\n         map: mapRef.current!,\n         position: pos,\n         title: s.title,\n         label: {\n@@ -214,9 +216,9 @@\n           fontWeight: \"600\",\n         },\n       });\n \n-      const info = new google.maps.InfoWindow({\n+      const info = new g.maps.InfoWindow({\n         content: `<div style=\\\"font-size:13px; font-weight:600; padding:2px 0;\\\">${s.title}</div>`,\n       });\n \n       marker.addListener(\"click\", () => info.open({ map: mapRef.current!, anchor: marker }));\n@@ -536,105 +538,109 @@\n                 </button>\n               </div>\n \n               {plan ? (\n-                <div className=\"mt-4 grid gap-3\">\n-                  {plan.items.map((it, idx) => (\n-                    <div\n-                      key={idx}\n-                      className={\n-                        \"rounded-2xl border border-white/12 p-4 transition \" +\n-                        (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n-                      }\n-                    >\n-                      <div className=\"flex items-center justify-between gap-3\">\n-                        <div className=\"text-sm font-semibold\">\n-                          {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n+                <div className=\"mt-4\">\n+                  <div className=\"grid gap-3\">\n+                    {plan.items.map((it, idx) => (\n+                      <div\n+                        key={idx}\n+                        className={\n+                          \"rounded-2xl border border-white/12 p-4 transition \" +\n+                          (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n+                        }\n+                      >\n+                        <div className=\"flex items-center justify-between gap-3\">\n+                          <div className=\"text-sm font-semibold\">\n+                            {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n+                          </div>\n+                          <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                         </div>\n-                        <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n-                      </div>\n \n-                      <div className=\"mt-2 flex gap-3\">\n-                        {it.type === \"stop\" && it.photoUrl ? (\n-                          <img\n-                            src={it.photoUrl}\n-                            alt={it.title}\n-                            className=\"h-16 w-16 rounded-xl object-cover ring-1 ring-white/10\"\n-                            loading=\"lazy\"\n-                            referrerPolicy=\"no-referrer\"\n-                          />\n-                        ) : null}\n+                        <div className=\"mt-2 flex gap-3\">\n+                          {it.type === \"stop\" && it.photoUrl ? (\n+                            <img\n+                              src={it.photoUrl}\n+                              alt={it.title}\n+                              className=\"h-16 w-16 rounded-xl object-cover ring-1 ring-white/10\"\n+                              loading=\"lazy\"\n+                              referrerPolicy=\"no-referrer\"\n+                            />\n+                          ) : null}\n \n-                        <div className=\"min-w-0 flex-1\">\n-                          <div className=\"text-sm text-white/85\">{it.title}</div>\n-                          {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n+                          <div className=\"min-w-0 flex-1\">\n+                            <div className=\"text-sm text-white/85\">{it.title}</div>\n+                            {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n \n-                          {it.type === \"stop\" ? (\n-                            <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n-                              {formatRating(it.rating, it.userRatingCount) ? (\n-                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n-                                  {formatRating(it.rating, it.userRatingCount)}\n-                                </span>\n-                              ) : null}\n+                            {it.type === \"stop\" ? (\n+                              <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n+                                {formatRating(it.rating, it.userRatingCount) ? (\n+                                  <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                    {formatRating(it.rating, it.userRatingCount)}\n+                                  </span>\n+                                ) : null}\n \n-                              {formatPriceLevel(it.priceLevel) ? (\n-                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n-                                  {formatPriceLevel(it.priceLevel)}\n-                                </span>\n-                              ) : null}\n+                                {formatPriceLevel(it.priceLevel) ? (\n+                                  <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                    {formatPriceLevel(it.priceLevel)}\n+                                  </span>\n+                                ) : null}\n \n-                              {typeof it.openNow === \"boolean\" ? (\n-                                <span\n-                                  className={\n-                                    \"rounded-full border px-2 py-0.5 \" +\n-                                    (it.openNow\n-                                      ? \"border-emerald-400/30 bg-emerald-400/10 text-emerald-200\"\n-                                      : \"border-rose-400/30 bg-rose-400/10 text-rose-200\")\n-                                  }\n-                                >\n-                                  {it.openNow ? \"Open now\" : \"Closed\"}\n-                                </span>\n-                              ) : null}\n+                                {typeof it.openNow === \"boolean\" ? (\n+                                  <span\n+                                    className={\n+                                      \"rounded-full border px-2 py-0.5 \" +\n+                                      (it.openNow\n+                                        ? \"border-emerald-400/30 bg-emerald-400/10 text-emerald-200\"\n+                                        : \"border-rose-400/30 bg-rose-400/10 text-rose-200\")\n+                                    }\n+                                  >\n+                                    {it.openNow ? \"Open now\" : \"Closed\"}\n+                                  </span>\n+                                ) : null}\n \n-                              {it.mapsUri ? (\n-                                <a\n-                                  href={it.mapsUri}\n-                                  target=\"_blank\"\n-                                  rel=\"noreferrer\"\n-                                  className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n-                                >\n-                                  Maps\n-                                </a>\n-                              ) : null}\n-                            </div>\n-                          ) : null}\n+                                {it.mapsUri ? (\n+                                  <a\n+                                    href={it.mapsUri}\n+                                    target=\"_blank\"\n+                                    rel=\"noreferrer\"\n+                                    className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n+                                  >\n+                                    Maps\n+                                  </a>\n+                                ) : null}\n+                              </div>\n+                            ) : null}\n \n-                          {it.type === \"stop\" && it.reviewSnippet ? (\n-                            <div className=\"mt-2 text-xs text-white/65\">“{it.reviewSnippet}”</div>\n-                          ) : null}\n+                            {it.type === \"stop\" && it.reviewSnippet ? (\n+                              <div className=\"mt-2 text-xs text-white/65\">“{it.reviewSnippet}”</div>\n+                            ) : null}\n \n-                          {it.type === \"stop\" && it.parking ? (\n-                            <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n-                              <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n-                              <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n-                              {it.parking.address ? <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div> : null}\n-                              {it.parking.mapsUri ? (\n-                                <a\n-                                  href={it.parking.mapsUri}\n-                                  target=\"_blank\"\n-                                  rel=\"noreferrer\"\n-                                  className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n-                                >\n-                                  Open parking in Maps..\n-                                </a>\n-                              ) : null}\n-                            </div>\n-                          ) : null}\n+                            {it.type === \"stop\" && it.parking ? (\n+                              <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n+                                <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n+                                <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n+                                {it.parking.address ? (\n+                                  <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div>\n+                                ) : null}\n+                                {it.parking.mapsUri ? (\n+                                  <a\n+                                    href={it.parking.mapsUri}\n+                                    target=\"_blank\"\n+                                    rel=\"noreferrer\"\n+                                    className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n+                                  >\n+                                    Open parking in Maps..\n+                                  </a>\n+                                ) : null}\n+                              </div>\n+                            ) : null}\n+                          </div>\n                         </div>\n                       </div>\n-                    </div>\n-                  ))}\n-                </div>\n+                    ))}\n+                  </div>\n+\n                   {showMap ? (\n                     mapsKey ? (\n                       <MapView apiKey={mapsKey} stops={mapStops} />\n                     ) : (\n@@ -649,9 +655,11 @@\n                 </div>\n               ) : (\n                 <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n                   <div className=\"text-sm font-semibold\">Try a sample</div>\n-                  <div className=\"mt-1 text-sm text-white/65\">Click <span className=\"text-white\">Quick demo</span> in the top right.</div>\n+                  <div className=\"mt-1 text-sm text-white/65\">\n+                    Click <span className=\"text-white\">Quick demo</span> in the top right.\n+                  </div>\n                 </div>\n               )}\n             </div>\n \n"
                },
                {
                    "date": 1766866406048,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -168,10 +168,11 @@\n }) {\n   const mapDivRef = useRef<HTMLDivElement | null>(null);\n   const mapRef = useRef<any>(null);\n   const markersRef = useRef<any[]>([]);\n+  const [loaded, setLoaded] = useState(false);\n \n-  const ready = typeof window !== \"undefined\" && (window as any).google?.maps;\n+  const ready = loaded && typeof window !== \"undefined\" && (window as any).google?.maps;\n \n   useEffect(() => {\n     if (!ready) return;\n     if (!mapDivRef.current) return;\n"
                },
                {
                    "date": 1766866437659,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -188,9 +188,9 @@\n       mapTypeControl: false,\n       fullscreenControl: false,\n       streetViewControl: false,\n     });\n-  }, [ready, stops]);\n+  }, [loaded, ready, stops]);\n \n   useEffect(() => {\n     if (!ready) return;\n     if (!mapRef.current) return;\n@@ -227,9 +227,9 @@\n       markersRef.current.push(marker);\n     });\n \n     mapRef.current.fitBounds(bounds, 80);\n-  }, [ready, stops]);\n+  }, [loaded, ready, stops]);\n \n   return (\n     <div className=\"mt-4 overflow-hidden rounded-2xl border border-white/10 bg-black/20\">\n       <div className=\"flex items-center justify-between border-b border-white/10 px-4 py-3\">\n"
                },
                {
                    "date": 1766866488956,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -235,10 +235,22 @@\n       <div className=\"flex items-center justify-between border-b border-white/10 px-4 py-3\">\n         <div className=\"text-sm font-semibold text-white/85\">Map</div>\n         <div className=\"text-xs text-white/55\">Stops: {stops.length}</div>\n       </div>\n-      <div ref={mapDivRef} className=\"h-[360px] w-full\" />\n-      <Script id=\"google-maps-js\" src={`https://maps.googleapis.com/maps/api/js?key=${apiKey}`} strategy=\"afterInteractive\" />\n+      {!ready ? (\n+  <div className=\"flex h-[360px] w-full items-center justify-center text-sm text-white/55\">\n+    Loading map…\n+  </div>\n+) : null}\n+\n+<div ref={mapDivRef} className={\"w-full \" + (ready ? \"h-[360px]\" : \"h-0\")} />\n+\n+  <Script\n+    id=\"google-maps-js\"\n+    src={`https://maps.googleapis.com/maps/api/js?key=${apiKey}`}\n+    strategy=\"afterInteractive\"\n+    onLoad={() => setLoaded(true)}\n+  />\n     </div>\n   );\n }\n \n"
                },
                {
                    "date": 1766866598691,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -482,25 +482,8 @@\n                 </button>\n               </div>\n             </div>\n \n-            <div className=\"mt-6 grid gap-3 sm:grid-cols-3\">\n-              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-xs text-white/55\">Format</div>\n-                <div className=\"mt-1 text-sm font-semibold\">Stops + travel</div>\n-                <div className=\"mt-1 text-sm text-white/65\">2–3 stops with realistic timing.</div>\n-              </div>\n-              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-xs text-white/55\">Routing</div>\n-                <div className=\"mt-1 text-sm font-semibold\">API-backed</div>\n-                <div className=\"mt-1 text-sm text-white/65\">Uses /api/itinerary in your app.</div>\n-              </div>\n-              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-xs text-white/55\">Next</div>\n-                <div className=\"mt-1 text-sm font-semibold\">Map view</div>\n-                <div className=\"mt-1 text-sm text-white/65\">Plot stops on a map.</div>\n-              </div>\n-            </div>\n           </div>\n \n           {/* preview */}\n           <div className=\"lg:pt-2\">\n"
                },
                {
                    "date": 1766867151058,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -677,13 +677,13 @@\n                   </div>\n                 </div>\n               </div>\n               <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-sm font-semibold\">Next upgrades</div>\n+                <div className=\"text-sm font-semibold\">Tips</div>\n                 <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n-                  <div>• Map + pins</div>\n-                  <div>• Park once mode</div>\n-                  <div>• Cost estimate</div>\n+                  <div>• Use Park once for walkable areas.</div>\n+                  <div>• Tap Maps to open directions.</div>\n+                  <div>• Toggle Map to see pins.</div>\n                 </div>\n               </div>\n             </div>\n           </div>\n"
                },
                {
                    "date": 1766867306518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -535,9 +535,22 @@\n               </div>\n \n               {plan ? (\n                 <div className=\"mt-4\">\n-                  <div className=\"grid gap-3\">\n+                  {showMap ? (\n+                    mapsKey ? (\n+                      <MapView apiKey={mapsKey} stops={mapStops} />\n+                    ) : (\n+                      <div className=\"rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n+                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n+                        <div className=\"mt-1 text-xs text-amber-100/80\">\n+                          Add it to <code>.env.local</code> and Vercel env vars, then restart.\n+                        </div>\n+                      </div>\n+                    )\n+                  ) : null}\n+\n+                  <div className=\"mt-4 grid gap-3\">\n                     {plan.items.map((it, idx) => (\n                       <div\n                         key={idx}\n                         className={\n@@ -634,21 +647,8 @@\n                         </div>\n                       </div>\n                     ))}\n                   </div>\n-\n-                  {showMap ? (\n-                    mapsKey ? (\n-                      <MapView apiKey={mapsKey} stops={mapStops} />\n-                    ) : (\n-                      <div className=\"mt-4 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n-                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n-                        <div className=\"mt-1 text-xs text-amber-100/80\">\n-                          Add it to <code>.env.local</code> and Vercel env vars, then restart.\n-                        </div>\n-                      </div>\n-                    )\n-                  ) : null}\n                 </div>\n               ) : (\n                 <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n                   <div className=\"text-sm font-semibold\">Try a sample</div>\n"
                },
                {
                    "date": 1766867471420,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -517,16 +517,8 @@\n                   </div>\n                 </div>\n                 <button\n                   className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n-                  onClick={() => setShowMap((v) => !v)}\n-                  disabled={!plan}\n-                  type=\"button\"\n-                >\n-                  {showMap ? \"Hide map\" : \"Show map\"}\n-                </button>\n-                <button\n-                  className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n                   onClick={() => setPlan(null)}\n                   disabled={!plan}\n                   type=\"button\"\n                 >\n@@ -534,121 +526,106 @@\n                 </button>\n               </div>\n \n               {plan ? (\n-                <div className=\"mt-4\">\n-                  {showMap ? (\n-                    mapsKey ? (\n-                      <MapView apiKey={mapsKey} stops={mapStops} />\n-                    ) : (\n-                      <div className=\"rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n-                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n-                        <div className=\"mt-1 text-xs text-amber-100/80\">\n-                          Add it to <code>.env.local</code> and Vercel env vars, then restart.\n+                <div className=\"mt-4 grid gap-3\">\n+                  {plan.items.map((it, idx) => (\n+                    <div\n+                      key={idx}\n+                      className={\n+                        \"rounded-2xl border border-white/12 p-4 transition \" +\n+                        (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n+                      }\n+                    >\n+                      <div className=\"flex items-center justify-between gap-3\">\n+                        <div className=\"text-sm font-semibold\">\n+                          {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n                         </div>\n+                        <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                       </div>\n-                    )\n-                  ) : null}\n \n-                  <div className=\"mt-4 grid gap-3\">\n-                    {plan.items.map((it, idx) => (\n-                      <div\n-                        key={idx}\n-                        className={\n-                          \"rounded-2xl border border-white/12 p-4 transition \" +\n-                          (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n-                        }\n-                      >\n-                        <div className=\"flex items-center justify-between gap-3\">\n-                          <div className=\"text-sm font-semibold\">\n-                            {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n-                          </div>\n-                          <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n-                        </div>\n+                      <div className=\"mt-2 flex gap-3\">\n+                        {it.type === \"stop\" && it.photoUrl ? (\n+                          <img\n+                            src={it.photoUrl}\n+                            alt={it.title}\n+                            className=\"h-16 w-16 rounded-xl object-cover ring-1 ring-white/10\"\n+                            loading=\"lazy\"\n+                            referrerPolicy=\"no-referrer\"\n+                          />\n+                        ) : null}\n \n-                        <div className=\"mt-2 flex gap-3\">\n-                          {it.type === \"stop\" && it.photoUrl ? (\n-                            <img\n-                              src={it.photoUrl}\n-                              alt={it.title}\n-                              className=\"h-16 w-16 rounded-xl object-cover ring-1 ring-white/10\"\n-                              loading=\"lazy\"\n-                              referrerPolicy=\"no-referrer\"\n-                            />\n-                          ) : null}\n+                        <div className=\"min-w-0 flex-1\">\n+                          <div className=\"text-sm text-white/85\">{it.title}</div>\n+                          {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n \n-                          <div className=\"min-w-0 flex-1\">\n-                            <div className=\"text-sm text-white/85\">{it.title}</div>\n-                            {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n+                          {it.type === \"stop\" ? (\n+                            <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n+                              {formatRating(it.rating, it.userRatingCount) ? (\n+                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                  {formatRating(it.rating, it.userRatingCount)}\n+                                </span>\n+                              ) : null}\n \n-                            {it.type === \"stop\" ? (\n-                              <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n-                                {formatRating(it.rating, it.userRatingCount) ? (\n-                                  <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n-                                    {formatRating(it.rating, it.userRatingCount)}\n-                                  </span>\n-                                ) : null}\n+                              {formatPriceLevel(it.priceLevel) ? (\n+                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                  {formatPriceLevel(it.priceLevel)}\n+                                </span>\n+                              ) : null}\n \n-                                {formatPriceLevel(it.priceLevel) ? (\n-                                  <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n-                                    {formatPriceLevel(it.priceLevel)}\n-                                  </span>\n-                                ) : null}\n+                              {typeof it.openNow === \"boolean\" ? (\n+                                <span\n+                                  className={\n+                                    \"rounded-full border px-2 py-0.5 \" +\n+                                    (it.openNow\n+                                      ? \"border-emerald-400/30 bg-emerald-400/10 text-emerald-200\"\n+                                      : \"border-rose-400/30 bg-rose-400/10 text-rose-200\")\n+                                  }\n+                                >\n+                                  {it.openNow ? \"Open now\" : \"Closed\"}\n+                                </span>\n+                              ) : null}\n \n-                                {typeof it.openNow === \"boolean\" ? (\n-                                  <span\n-                                    className={\n-                                      \"rounded-full border px-2 py-0.5 \" +\n-                                      (it.openNow\n-                                        ? \"border-emerald-400/30 bg-emerald-400/10 text-emerald-200\"\n-                                        : \"border-rose-400/30 bg-rose-400/10 text-rose-200\")\n-                                    }\n-                                  >\n-                                    {it.openNow ? \"Open now\" : \"Closed\"}\n-                                  </span>\n-                                ) : null}\n+                              {it.mapsUri ? (\n+                                <a\n+                                  href={it.mapsUri}\n+                                  target=\"_blank\"\n+                                  rel=\"noreferrer\"\n+                                  className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n+                                >\n+                                  Maps\n+                                </a>\n+                              ) : null}\n+                            </div>\n+                          ) : null}\n \n-                                {it.mapsUri ? (\n-                                  <a\n-                                    href={it.mapsUri}\n-                                    target=\"_blank\"\n-                                    rel=\"noreferrer\"\n-                                    className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n-                                  >\n-                                    Maps\n-                                  </a>\n-                                ) : null}\n-                              </div>\n-                            ) : null}\n+                          {it.type === \"stop\" && it.reviewSnippet ? (\n+                            <div className=\"mt-2 text-xs text-white/65\">“{it.reviewSnippet}”</div>\n+                          ) : null}\n \n-                            {it.type === \"stop\" && it.reviewSnippet ? (\n-                              <div className=\"mt-2 text-xs text-white/65\">“{it.reviewSnippet}”</div>\n-                            ) : null}\n-\n-                            {it.type === \"stop\" && it.parking ? (\n-                              <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n-                                <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n-                                <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n-                                {it.parking.address ? (\n-                                  <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div>\n-                                ) : null}\n-                                {it.parking.mapsUri ? (\n-                                  <a\n-                                    href={it.parking.mapsUri}\n-                                    target=\"_blank\"\n-                                    rel=\"noreferrer\"\n-                                    className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n-                                  >\n-                                    Open parking in Maps..\n-                                  </a>\n-                                ) : null}\n-                              </div>\n-                            ) : null}\n-                          </div>\n+                          {it.type === \"stop\" && it.parking ? (\n+                            <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n+                              <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n+                              <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n+                              {it.parking.address ? (\n+                                <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div>\n+                              ) : null}\n+                              {it.parking.mapsUri ? (\n+                                <a\n+                                  href={it.parking.mapsUri}\n+                                  target=\"_blank\"\n+                                  rel=\"noreferrer\"\n+                                  className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n+                                >\n+                                  Open parking in Maps..\n+                                </a>\n+                              ) : null}\n+                            </div>\n+                          ) : null}\n                         </div>\n                       </div>\n-                    ))}\n-                  </div>\n+                    </div>\n+                  ))}\n                 </div>\n               ) : (\n                 <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n                   <div className=\"text-sm font-semibold\">Try a sample</div>\n@@ -702,4 +679,33 @@\n       </footer>\n     </main>\n   );\n }\n+\n+            {/* Map view below Generate button */}\n+            {plan ? (\n+              <div className=\"mt-4\">\n+                <div className=\"flex items-center justify-between\">\n+                  <div className=\"text-xs text-white/60\">Map</div>\n+                  <button\n+                    className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n+                    onClick={() => setShowMap((v) => !v)}\n+                    type=\"button\"\n+                  >\n+                    {showMap ? \"Hide\" : \"Show\"}\n+                  </button>\n+                </div>\n+\n+                {showMap ? (\n+                  mapsKey ? (\n+                    <MapView apiKey={mapsKey} stops={mapStops} />\n+                  ) : (\n+                    <div className=\"mt-3 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n+                      Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n+                      <div className=\"mt-1 text-xs text-amber-100/80\">\n+                        Add it to <code>.env.local</code> and Vercel env vars, then restart.\n+                      </div>\n+                    </div>\n+                  )\n+                ) : null}\n+              </div>\n+            ) : null}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1766868291806,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,8 +67,52 @@\n   const c = typeof count === \"number\" ? ` (${count.toLocaleString()})` : \"\";\n   return `${r}★${c}`;\n }\n \n+function latLngStr(p?: { lat: number; lng: number } | null) {\n+  if (!p) return \"\";\n+  return `${p.lat},${p.lng}`;\n+}\n+\n+function buildGoogleMapsRouteUrl(args: {\n+  origin?: { lat: number; lng: number } | null;\n+  stops: { lat: number; lng: number }[];\n+  travelMode?: \"driving\" | \"walking\";\n+}) {\n+  const { origin, stops, travelMode = \"driving\" } = args;\n+  if (!stops || stops.length === 0) return \"https://www.google.com/maps\";\n+\n+  const destination = latLngStr(stops[stops.length - 1]);\n+  const waypoints = stops\n+    .slice(0, -1)\n+    .map((s) => latLngStr(s))\n+    .filter(Boolean)\n+    .join(\"|\");\n+\n+  const params = new URLSearchParams();\n+  params.set(\"api\", \"1\");\n+  if (origin) params.set(\"origin\", latLngStr(origin));\n+  params.set(\"destination\", destination);\n+  if (waypoints) params.set(\"waypoints\", waypoints);\n+  params.set(\"travelmode\", travelMode);\n+\n+  return `https://www.google.com/maps/dir/?${params.toString()}`;\n+}\n+\n+function buildGoogleMapsToStopUrl(args: {\n+  origin?: { lat: number; lng: number } | null;\n+  destination: { lat: number; lng: number };\n+  travelMode?: \"driving\" | \"walking\";\n+}) {\n+  const { origin, destination, travelMode = \"driving\" } = args;\n+  const params = new URLSearchParams();\n+  params.set(\"api\", \"1\");\n+  if (origin) params.set(\"origin\", latLngStr(origin));\n+  params.set(\"destination\", latLngStr(destination));\n+  params.set(\"travelmode\", travelMode);\n+  return `https://www.google.com/maps/dir/?${params.toString()}`;\n+}\n+\n function estimateCostRange(items: PlanItem[]) {\n   // very rough per-stop estimates (USD)\n   // Free: 0-0, $: 10-25, $$: 25-60, $$$: 60-120, $$$$: 120-250\n   const stopItems = items.filter((x) => x.type === \"stop\");\n@@ -161,15 +205,20 @@\n \n function MapView({\n   apiKey,\n   stops,\n+  origin,\n+  travelMode,\n }: {\n   apiKey: string;\n   stops: { title: string; lat: number; lng: number }[];\n+  origin?: { lat: number; lng: number } | null;\n+  travelMode?: \"DRIVING\" | \"WALKING\";\n }) {\n   const mapDivRef = useRef<HTMLDivElement | null>(null);\n   const mapRef = useRef<any>(null);\n   const markersRef = useRef<any[]>([]);\n+  const directionsRef = useRef<any>(null);\n   const [loaded, setLoaded] = useState(false);\n \n   const ready = loaded && typeof window !== \"undefined\" && (window as any).google?.maps;\n \n@@ -188,9 +237,9 @@\n       mapTypeControl: false,\n       fullscreenControl: false,\n       streetViewControl: false,\n     });\n-  }, [loaded, ready, stops]);\n+  }, [loaded, ready, stops, origin]);\n \n   useEffect(() => {\n     if (!ready) return;\n     if (!mapRef.current) return;\n@@ -202,8 +251,12 @@\n \n     const g = (window as any).google;\n     const bounds = new g.maps.LatLngBounds();\n \n+    if (origin?.lat != null && origin?.lng != null) {\n+      bounds.extend({ lat: origin.lat, lng: origin.lng });\n+    }\n+\n     stops.forEach((s, idx) => {\n       const pos = { lat: s.lat, lng: s.lng };\n       bounds.extend(pos);\n \n@@ -227,30 +280,82 @@\n       markersRef.current.push(marker);\n     });\n \n     mapRef.current.fitBounds(bounds, 80);\n-  }, [loaded, ready, stops]);\n+  }, [loaded, ready, stops, origin]);\n \n+  useEffect(() => {\n+    if (!ready || !mapRef.current) return;\n+    if (!origin || origin.lat == null || origin.lng == null) return;\n+    if (!stops || stops.length === 0) return;\n+\n+    const g = (window as any).google;\n+\n+    // Clean up any previous renderer\n+    if (directionsRef.current) {\n+      try {\n+        directionsRef.current.setMap(null);\n+      } catch {}\n+      directionsRef.current = null;\n+    }\n+\n+    const ds = new g.maps.DirectionsService();\n+    const dr = new g.maps.DirectionsRenderer({\n+      suppressMarkers: true,\n+      preserveViewport: true,\n+    });\n+\n+    dr.setMap(mapRef.current);\n+    directionsRef.current = dr;\n+\n+    const mode = travelMode === \"WALKING\" ? g.maps.TravelMode.WALKING : g.maps.TravelMode.DRIVING;\n+\n+    const pts = stops.map((s) => ({ lat: s.lat, lng: s.lng }));\n+    const destination = pts[pts.length - 1];\n+    const waypoints = pts.slice(0, -1).map((p) => ({ location: p, stopover: true }));\n+\n+    ds.route(\n+      {\n+        origin: { lat: origin.lat, lng: origin.lng },\n+        destination,\n+        waypoints,\n+        travelMode: mode,\n+        optimizeWaypoints: false,\n+      },\n+      (result: any, status: string) => {\n+        if (status === \"OK\" && result) {\n+          dr.setDirections(result);\n+        }\n+      }\n+    );\n+\n+    return () => {\n+      try {\n+        dr.setMap(null);\n+      } catch {}\n+    };\n+  }, [loaded, ready, origin, travelMode, stops]);\n+\n   return (\n     <div className=\"mt-4 overflow-hidden rounded-2xl border border-white/10 bg-black/20\">\n       <div className=\"flex items-center justify-between border-b border-white/10 px-4 py-3\">\n         <div className=\"text-sm font-semibold text-white/85\">Map</div>\n-        <div className=\"text-xs text-white/55\">Stops: {stops.length}</div>\n+        <div className=\"text-xs text-white/55\">Stops: {stops.length}{origin ? \" + you\" : \"\"}</div>\n       </div>\n       {!ready ? (\n-  <div className=\"flex h-[360px] w-full items-center justify-center text-sm text-white/55\">\n-    Loading map…\n-  </div>\n-) : null}\n+        <div className=\"flex h-[360px] w-full items-center justify-center text-sm text-white/55\">\n+          Loading map…\n+        </div>\n+      ) : null}\n \n-<div ref={mapDivRef} className={\"w-full \" + (ready ? \"h-[360px]\" : \"h-0\")} />\n+      <div ref={mapDivRef} className={\"w-full \" + (ready ? \"h-[360px]\" : \"h-0\")} />\n \n-  <Script\n-    id=\"google-maps-js\"\n-    src={`https://maps.googleapis.com/maps/api/js?key=${apiKey}`}\n-    strategy=\"afterInteractive\"\n-    onLoad={() => setLoaded(true)}\n-  />\n+      <Script\n+        id=\"google-maps-js\"\n+        src={`https://maps.googleapis.com/maps/api/js?key=${apiKey}`}\n+        strategy=\"afterInteractive\"\n+        onLoad={() => setLoaded(true)}\n+      />\n     </div>\n   );\n }\n \n@@ -263,8 +368,10 @@\n   const [loading, setLoading] = useState(false);\n \n   const [parkOnce, setParkOnce] = useState(false);\n   const [showMap, setShowMap] = useState(true);\n+  const [userLoc, setUserLoc] = useState<{ lat: number; lng: number } | null>(null);\n+  const [locError, setLocError] = useState<string | null>(null);\n \n   const mapsKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || \"\";\n \n   const mapStops = useMemo(() => {\n@@ -273,10 +380,39 @@\n       .filter((it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\")\n       .map((it) => ({ title: it.title, lat: it.lat as number, lng: it.lng as number }));\n   }, [plan]);\n \n+  const routeStops = useMemo(() => {\n+    if (!plan) return [] as { lat: number; lng: number }[];\n+    return plan.items\n+      .filter((it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\")\n+      .map((it) => ({ lat: it.lat as number, lng: it.lng as number }));\n+  }, [plan]);\n+\n   const cost = useMemo(() => (plan ? estimateCostRange(plan.items) : null), [plan]);\n \n+  async function captureMyLocation() {\n+    setLocError(null);\n+    if (typeof window === \"undefined\" || !navigator?.geolocation) {\n+      setLocError(\"Geolocation not available in this browser.\");\n+      return;\n+    }\n+\n+    return new Promise<void>((resolve) => {\n+      navigator.geolocation.getCurrentPosition(\n+        (pos) => {\n+          setUserLoc({ lat: pos.coords.latitude, lng: pos.coords.longitude });\n+          resolve();\n+        },\n+        (err) => {\n+          setLocError(err?.message || \"Location permission denied.\");\n+          resolve();\n+        },\n+        { enableHighAccuracy: true, timeout: 10000, maximumAge: 60_000 }\n+      );\n+    });\n+  }\n+\n   const onGenerate = async () => {\n     const dest = destination.trim();\n \n     if (!dest) {\n@@ -302,8 +438,9 @@\n       }\n \n       const data = (await res.json()) as PlanResponse;\n       setPlan(data);\n+      void captureMyLocation();\n     } catch (e) {\n       const msg = e instanceof Error ? e.message : \"Could not generate itinerary.\";\n       setError(msg);\n       setPlan(null);\n@@ -584,11 +721,15 @@\n                                   {it.openNow ? \"Open now\" : \"Closed\"}\n                                 </span>\n                               ) : null}\n \n-                              {it.mapsUri ? (\n+                              {typeof it.lat === \"number\" && typeof it.lng === \"number\" ? (\n                                 <a\n-                                  href={it.mapsUri}\n+                                  href={buildGoogleMapsToStopUrl({\n+                                    origin: userLoc,\n+                                    destination: { lat: it.lat, lng: it.lng },\n+                                    travelMode: plan?.parkOnce ? \"walking\" : \"driving\",\n+                                  })}\n                                   target=\"_blank\"\n                                   rel=\"noreferrer\"\n                                   className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n                                 >\n@@ -626,8 +767,70 @@\n                     </div>\n                   ))}\n                 </div>\n               ) : (\n+              {plan ? (\n+                <div className=\"mt-4\">\n+                  <div className=\"flex items-center justify-between\">\n+                    <div className=\"text-xs text-white/60\">Map</div>\n+                    <button\n+                      className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n+                      onClick={() => setShowMap((v) => !v)}\n+                      type=\"button\"\n+                    >\n+                      {showMap ? \"Hide\" : \"Show\"}\n+                    </button>\n+                  </div>\n+\n+                  <div className=\"mt-2 flex items-center justify-between gap-2\">\n+                    <div className=\"text-xs text-white/55\">\n+                      {userLoc ? \"Route starts from your current location\" : \"Tip: click ‘Use my location’ for better routes\"}\n+                    </div>\n+                    <div className=\"flex items-center gap-2\">\n+                      <button\n+                        type=\"button\"\n+                        onClick={() => void captureMyLocation()}\n+                        className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n+                      >\n+                        Use my location\n+                      </button>\n+\n+                      <a\n+                        href={buildGoogleMapsRouteUrl({\n+                          origin: userLoc,\n+                          stops: routeStops,\n+                          travelMode: plan?.parkOnce ? \"walking\" : \"driving\",\n+                        })}\n+                        target=\"_blank\"\n+                        rel=\"noreferrer\"\n+                        className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n+                      >\n+                        Open full route\n+                      </a>\n+                    </div>\n+                  </div>\n+\n+                  {locError ? <div className=\"mt-2 text-xs text-rose-200/90\">{locError}</div> : null}\n+\n+                  {showMap ? (\n+                    mapsKey ? (\n+                      <MapView\n+                        apiKey={mapsKey}\n+                        stops={mapStops}\n+                        origin={userLoc}\n+                        travelMode={plan?.parkOnce ? \"WALKING\" : \"DRIVING\"}\n+                      />\n+                    ) : (\n+                      <div className=\"mt-3 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n+                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n+                        <div className=\"mt-1 text-xs text-amber-100/80\">\n+                          Add it to <code>.env.local</code> and Vercel env vars, then restart.\n+                        </div>\n+                      </div>\n+                    )\n+                  ) : null}\n+                </div>\n+              ) : null}\n                 <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n                   <div className=\"text-sm font-semibold\">Try a sample</div>\n                   <div className=\"mt-1 text-sm text-white/65\">\n                     Click <span className=\"text-white\">Quick demo</span> in the top right.\n@@ -679,33 +882,4 @@\n       </footer>\n     </main>\n   );\n }\n-\n-            {/* Map view below Generate button */}\n-            {plan ? (\n-              <div className=\"mt-4\">\n-                <div className=\"flex items-center justify-between\">\n-                  <div className=\"text-xs text-white/60\">Map</div>\n-                  <button\n-                    className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n-                    onClick={() => setShowMap((v) => !v)}\n-                    type=\"button\"\n-                  >\n-                    {showMap ? \"Hide\" : \"Show\"}\n-                  </button>\n-                </div>\n-\n-                {showMap ? (\n-                  mapsKey ? (\n-                    <MapView apiKey={mapsKey} stops={mapStops} />\n-                  ) : (\n-                    <div className=\"mt-3 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n-                      Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n-                      <div className=\"mt-1 text-xs text-amber-100/80\">\n-                        Add it to <code>.env.local</code> and Vercel env vars, then restart.\n-                      </div>\n-                    </div>\n-                  )\n-                ) : null}\n-              </div>\n-            ) : null}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1766868412881,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -617,8 +617,73 @@\n                   {loading ? \"Generating…\" : \"Generate\"}\n                   <IconArrow className=\"h-4 w-4 transition group-hover:translate-x-0.5\" />\n                 </button>\n               </div>\n+\n+              {plan ? (\n+                <div className=\"mt-4\">\n+                  <div className=\"flex items-center justify-between\">\n+                    <div className=\"text-xs text-white/60\">Map</div>\n+                    <button\n+                      className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n+                      onClick={() => setShowMap((v) => !v)}\n+                      type=\"button\"\n+                    >\n+                      {showMap ? \"Hide\" : \"Show\"}\n+                    </button>\n+                  </div>\n+\n+                  <div className=\"mt-2 flex items-center justify-between gap-2\">\n+                    <div className=\"text-xs text-white/55\">\n+                      {userLoc\n+                        ? \"Route starts from your current location\"\n+                        : \"Tip: click ‘Use my location’ for better routes\"}\n+                    </div>\n+                    <div className=\"flex items-center gap-2\">\n+                      <button\n+                        type=\"button\"\n+                        onClick={() => void captureMyLocation()}\n+                        className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n+                      >\n+                        Use my location\n+                      </button>\n+\n+                      <a\n+                        href={buildGoogleMapsRouteUrl({\n+                          origin: userLoc,\n+                          stops: routeStops,\n+                          travelMode: parkOnce ? \"walking\" : \"driving\",\n+                        })}\n+                        target=\"_blank\"\n+                        rel=\"noreferrer\"\n+                        className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n+                      >\n+                        Open full route\n+                      </a>\n+                    </div>\n+                  </div>\n+\n+                  {locError ? <div className=\"mt-2 text-xs text-rose-200/90\">{locError}</div> : null}\n+\n+                  {showMap ? (\n+                    mapsKey ? (\n+                      <MapView\n+                        apiKey={mapsKey}\n+                        stops={mapStops}\n+                        origin={userLoc}\n+                        travelMode={parkOnce ? \"WALKING\" : \"DRIVING\"}\n+                      />\n+                    ) : (\n+                      <div className=\"mt-3 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n+                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n+                        <div className=\"mt-1 text-xs text-amber-100/80\">\n+                          Add it to <code>.env.local</code> and Vercel env vars, then restart.\n+                        </div>\n+                      </div>\n+                    )\n+                  ) : null}\n+                </div>\n+              ) : null}\n             </div>\n \n           </div>\n \n@@ -767,70 +832,8 @@\n                     </div>\n                   ))}\n                 </div>\n               ) : (\n-              {plan ? (\n-                <div className=\"mt-4\">\n-                  <div className=\"flex items-center justify-between\">\n-                    <div className=\"text-xs text-white/60\">Map</div>\n-                    <button\n-                      className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n-                      onClick={() => setShowMap((v) => !v)}\n-                      type=\"button\"\n-                    >\n-                      {showMap ? \"Hide\" : \"Show\"}\n-                    </button>\n-                  </div>\n-\n-                  <div className=\"mt-2 flex items-center justify-between gap-2\">\n-                    <div className=\"text-xs text-white/55\">\n-                      {userLoc ? \"Route starts from your current location\" : \"Tip: click ‘Use my location’ for better routes\"}\n-                    </div>\n-                    <div className=\"flex items-center gap-2\">\n-                      <button\n-                        type=\"button\"\n-                        onClick={() => void captureMyLocation()}\n-                        className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n-                      >\n-                        Use my location\n-                      </button>\n-\n-                      <a\n-                        href={buildGoogleMapsRouteUrl({\n-                          origin: userLoc,\n-                          stops: routeStops,\n-                          travelMode: plan?.parkOnce ? \"walking\" : \"driving\",\n-                        })}\n-                        target=\"_blank\"\n-                        rel=\"noreferrer\"\n-                        className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10\"\n-                      >\n-                        Open full route\n-                      </a>\n-                    </div>\n-                  </div>\n-\n-                  {locError ? <div className=\"mt-2 text-xs text-rose-200/90\">{locError}</div> : null}\n-\n-                  {showMap ? (\n-                    mapsKey ? (\n-                      <MapView\n-                        apiKey={mapsKey}\n-                        stops={mapStops}\n-                        origin={userLoc}\n-                        travelMode={plan?.parkOnce ? \"WALKING\" : \"DRIVING\"}\n-                      />\n-                    ) : (\n-                      <div className=\"mt-3 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n-                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n-                        <div className=\"mt-1 text-xs text-amber-100/80\">\n-                          Add it to <code>.env.local</code> and Vercel env vars, then restart.\n-                        </div>\n-                      </div>\n-                    )\n-                  ) : null}\n-                </div>\n-              ) : null}\n                 <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n                   <div className=\"text-sm font-semibold\">Try a sample</div>\n                   <div className=\"mt-1 text-sm text-white/65\">\n                     Click <span className=\"text-white\">Quick demo</span> in the top right.\n"
                },
                {
                    "date": 1766868521536,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -501,9 +501,9 @@\n       </header>\n \n       {/* hero */}\n       <section className=\"mx-auto max-w-6xl px-4 pb-8 pt-10\">\n-        <div className=\"grid items-start gap-8 lg:grid-cols-2\">\n+        <div className=\"grid items-start gap-8\">\n           <div>\n             <div className=\"inline-flex items-center gap-2 rounded-full border border-white/15 bg-white/5 px-3 py-1.5 text-xs text-white/80\">\n               <IconSparkle className=\"h-4 w-4\" />\n               <span>Short, realistic plans</span>\n@@ -684,192 +684,194 @@\n                 </div>\n               ) : null}\n             </div>\n \n-          </div>\n-\n-          {/* preview */}\n-          <div className=\"lg:pt-2\">\n-            <div className=\"rounded-3xl border border-white/12 bg-white/5 p-5 shadow-[0_0_0_1px_rgba(255,255,255,0.06)] backdrop-blur\">\n-              <div className=\"flex items-start justify-between gap-3\">\n-                <div>\n-                  <div className=\"text-xs text-white/60\">Preview</div>\n-                  <div className=\"mt-1 text-lg font-semibold\">Your itinerary</div>\n-                  <div className=\"mt-1 text-sm text-white/60\">\n-                    {plan ? (\n-                      <>\n-                        {plan.destination || \"—\"} • {plan.totalMinutes} min • {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n-                        {plan.items?.some((x) => x.type === \"stop\" && (x.photoUrl || x.rating || x.priceLevel || x.openNow !== undefined || x.reviewSnippet || x.parking)) ? (\n-                          <span className=\"ml-2 rounded-full border border-emerald-400/30 bg-emerald-400/10 px-2 py-0.5 text-xs text-emerald-200\">\n-                            Enriched\n-                          </span>\n-                        ) : (\n-                          <span className=\"ml-2 rounded-full border border-rose-400/30 bg-rose-400/10 px-2 py-0.5 text-xs text-rose-200\">\n-                            Basic\n-                          </span>\n-                        )}\n-                        {cost ? (\n-                          <span className=\"ml-2 rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-xs text-white/80\">\n-                            Est. ${cost.min}–${cost.max}\n-                          </span>\n-                        ) : null}\n-                      </>\n-                    ) : (\n-                      \"Generate to see your plan here\"\n-                    )}\n+            {/* preview (moved below planner) */}\n+            <div className=\"mt-8\">\n+              <div className=\"rounded-3xl border border-white/12 bg-white/5 p-5 shadow-[0_0_0_1px_rgba(255,255,255,0.06)] backdrop-blur\">\n+                <div className=\"flex items-start justify-between gap-3\">\n+                  <div>\n+                    <div className=\"text-xs text-white/60\">Preview</div>\n+                    <div className=\"mt-1 text-lg font-semibold\">Your itinerary</div>\n+                    <div className=\"mt-1 text-sm text-white/60\">\n+                      {plan ? (\n+                        <>\n+                          {plan.destination || \"—\"} • {plan.totalMinutes} min • {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n+                          {plan.items?.some(\n+                            (x) => x.type === \"stop\" && (x.photoUrl || x.rating || x.priceLevel || x.openNow !== undefined || x.reviewSnippet || x.parking)\n+                          ) ? (\n+                            <span className=\"ml-2 rounded-full border border-emerald-400/30 bg-emerald-400/10 px-2 py-0.5 text-xs text-emerald-200\">\n+                              Enriched\n+                            </span>\n+                          ) : (\n+                            <span className=\"ml-2 rounded-full border border-rose-400/30 bg-rose-400/10 px-2 py-0.5 text-xs text-rose-200\">\n+                              Basic\n+                            </span>\n+                          )}\n+                          {cost ? (\n+                            <span className=\"ml-2 rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-xs text-white/80\">\n+                              Est. ${cost.min}–${cost.max}\n+                            </span>\n+                          ) : null}\n+                        </>\n+                      ) : (\n+                        \"Generate to see your plan here\"\n+                      )}\n+                    </div>\n                   </div>\n+                  <button\n+                    className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n+                    onClick={() => setPlan(null)}\n+                    disabled={!plan}\n+                    type=\"button\"\n+                  >\n+                    Clear\n+                  </button>\n                 </div>\n-                <button\n-                  className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/85 transition hover:bg-white/10 disabled:opacity-40\"\n-                  onClick={() => setPlan(null)}\n-                  disabled={!plan}\n-                  type=\"button\"\n-                >\n-                  Clear\n-                </button>\n-              </div>\n \n-              {plan ? (\n-                <div className=\"mt-4 grid gap-3\">\n-                  {plan.items.map((it, idx) => (\n-                    <div\n-                      key={idx}\n-                      className={\n-                        \"rounded-2xl border border-white/12 p-4 transition \" +\n-                        (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n-                      }\n-                    >\n-                      <div className=\"flex items-center justify-between gap-3\">\n-                        <div className=\"text-sm font-semibold\">\n-                          {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n+                {plan ? (\n+                  <div className=\"mt-4 grid gap-3\">\n+                    {plan.items.map((it, idx) => (\n+                      <div\n+                        key={idx}\n+                        className={\n+                          \"rounded-2xl border border-white/12 p-4 transition \" +\n+                          (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n+                        }\n+                      >\n+                        <div className=\"flex items-center justify-between gap-3\">\n+                          <div className=\"text-sm font-semibold\">\n+                            {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n+                          </div>\n+                          <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                         </div>\n-                        <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n-                      </div>\n \n-                      <div className=\"mt-2 flex gap-3\">\n-                        {it.type === \"stop\" && it.photoUrl ? (\n-                          <img\n-                            src={it.photoUrl}\n-                            alt={it.title}\n-                            className=\"h-16 w-16 rounded-xl object-cover ring-1 ring-white/10\"\n-                            loading=\"lazy\"\n-                            referrerPolicy=\"no-referrer\"\n-                          />\n-                        ) : null}\n+                        <div className=\"mt-2 flex gap-3\">\n+                          {it.type === \"stop\" && it.photoUrl ? (\n+                            <img\n+                              src={it.photoUrl}\n+                              alt={it.title}\n+                              className=\"h-16 w-16 rounded-xl object-cover ring-1 ring-white/10\"\n+                              loading=\"lazy\"\n+                              referrerPolicy=\"no-referrer\"\n+                            />\n+                          ) : null}\n \n-                        <div className=\"min-w-0 flex-1\">\n-                          <div className=\"text-sm text-white/85\">{it.title}</div>\n-                          {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n+                          <div className=\"min-w-0 flex-1\">\n+                            <div className=\"text-sm text-white/85\">{it.title}</div>\n+                            {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n \n-                          {it.type === \"stop\" ? (\n-                            <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n-                              {formatRating(it.rating, it.userRatingCount) ? (\n-                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n-                                  {formatRating(it.rating, it.userRatingCount)}\n-                                </span>\n-                              ) : null}\n+                            {it.type === \"stop\" ? (\n+                              <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n+                                {formatRating(it.rating, it.userRatingCount) ? (\n+                                  <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                    {formatRating(it.rating, it.userRatingCount)}\n+                                  </span>\n+                                ) : null}\n \n-                              {formatPriceLevel(it.priceLevel) ? (\n-                                <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n-                                  {formatPriceLevel(it.priceLevel)}\n-                                </span>\n-                              ) : null}\n+                                {formatPriceLevel(it.priceLevel) ? (\n+                                  <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n+                                    {formatPriceLevel(it.priceLevel)}\n+                                  </span>\n+                                ) : null}\n \n-                              {typeof it.openNow === \"boolean\" ? (\n-                                <span\n-                                  className={\n-                                    \"rounded-full border px-2 py-0.5 \" +\n-                                    (it.openNow\n-                                      ? \"border-emerald-400/30 bg-emerald-400/10 text-emerald-200\"\n-                                      : \"border-rose-400/30 bg-rose-400/10 text-rose-200\")\n-                                  }\n-                                >\n-                                  {it.openNow ? \"Open now\" : \"Closed\"}\n-                                </span>\n-                              ) : null}\n+                                {typeof it.openNow === \"boolean\" ? (\n+                                  <span\n+                                    className={\n+                                      \"rounded-full border px-2 py-0.5 \" +\n+                                      (it.openNow\n+                                        ? \"border-emerald-400/30 bg-emerald-400/10 text-emerald-200\"\n+                                        : \"border-rose-400/30 bg-rose-400/10 text-rose-200\")\n+                                    }\n+                                  >\n+                                    {it.openNow ? \"Open now\" : \"Closed\"}\n+                                  </span>\n+                                ) : null}\n \n-                              {typeof it.lat === \"number\" && typeof it.lng === \"number\" ? (\n-                                <a\n-                                  href={buildGoogleMapsToStopUrl({\n-                                    origin: userLoc,\n-                                    destination: { lat: it.lat, lng: it.lng },\n-                                    travelMode: plan?.parkOnce ? \"walking\" : \"driving\",\n-                                  })}\n-                                  target=\"_blank\"\n-                                  rel=\"noreferrer\"\n-                                  className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n-                                >\n-                                  Maps\n-                                </a>\n-                              ) : null}\n-                            </div>\n-                          ) : null}\n+                                {typeof it.lat === \"number\" && typeof it.lng === \"number\" ? (\n+                                  <a\n+                                    href={buildGoogleMapsToStopUrl({\n+                                      origin: userLoc,\n+                                      destination: { lat: it.lat, lng: it.lng },\n+                                      travelMode: plan?.parkOnce ? \"walking\" : \"driving\",\n+                                    })}\n+                                    target=\"_blank\"\n+                                    rel=\"noreferrer\"\n+                                    className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80 hover:bg-white/10\"\n+                                  >\n+                                    Maps\n+                                  </a>\n+                                ) : null}\n+                              </div>\n+                            ) : null}\n \n-                          {it.type === \"stop\" && it.reviewSnippet ? (\n-                            <div className=\"mt-2 text-xs text-white/65\">“{it.reviewSnippet}”</div>\n-                          ) : null}\n+                            {it.type === \"stop\" && it.reviewSnippet ? (\n+                              <div className=\"mt-2 text-xs text-white/65\">“{it.reviewSnippet}”</div>\n+                            ) : null}\n \n-                          {it.type === \"stop\" && it.parking ? (\n-                            <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n-                              <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n-                              <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n-                              {it.parking.address ? (\n-                                <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div>\n-                              ) : null}\n-                              {it.parking.mapsUri ? (\n-                                <a\n-                                  href={it.parking.mapsUri}\n-                                  target=\"_blank\"\n-                                  rel=\"noreferrer\"\n-                                  className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n-                                >\n-                                  Open parking in Maps..\n-                                </a>\n-                              ) : null}\n-                            </div>\n-                          ) : null}\n+                            {it.type === \"stop\" && it.parking ? (\n+                              <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n+                                <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n+                                <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n+                                {it.parking.address ? (\n+                                  <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div>\n+                                ) : null}\n+                                {it.parking.mapsUri ? (\n+                                  <a\n+                                    href={it.parking.mapsUri}\n+                                    target=\"_blank\"\n+                                    rel=\"noreferrer\"\n+                                    className=\"mt-2 inline-flex text-xs text-white/70 underline decoration-white/30 hover:text-white\"\n+                                  >\n+                                    Open parking in Maps..\n+                                  </a>\n+                                ) : null}\n+                              </div>\n+                            ) : null}\n+                          </div>\n                         </div>\n                       </div>\n+                    ))}\n+                  </div>\n+                ) : (\n+                  <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n+                    <div className=\"text-sm font-semibold\">Try a sample</div>\n+                    <div className=\"mt-1 text-sm text-white/65\">\n+                      Click <span className=\"text-white\">Quick demo</span> in the top right.\n                     </div>\n-                  ))}\n-                </div>\n-              ) : (\n-                <div className=\"mt-6 rounded-2xl border border-white/12 bg-black/20 p-6\">\n-                  <div className=\"text-sm font-semibold\">Try a sample</div>\n-                  <div className=\"mt-1 text-sm text-white/65\">\n-                    Click <span className=\"text-white\">Quick demo</span> in the top right.\n                   </div>\n-                </div>\n-              )}\n-            </div>\n+                )}\n+              </div>\n \n-            <div className=\"mt-4 grid gap-3 sm:grid-cols-2\">\n-              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-sm font-semibold\">How it works</div>\n-                <div className=\"mt-2 space-y-2 text-sm text-white/70\">\n-                  <div className=\"flex gap-2\">\n-                    <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">1</span>\n-                    <span>Destination + duration</span>\n+              <div className=\"mt-4 grid gap-3 sm:grid-cols-2\">\n+                <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n+                  <div className=\"text-sm font-semibold\">How it works</div>\n+                  <div className=\"mt-2 space-y-2 text-sm text-white/70\">\n+                    <div className=\"flex gap-2\">\n+                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">1</span>\n+                      <span>Destination + duration</span>\n+                    </div>\n+                    <div className=\"flex gap-2\">\n+                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">2</span>\n+                      <span>Pick your vibe</span>\n+                    </div>\n+                    <div className=\"flex gap-2\">\n+                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">3</span>\n+                      <span>Generate a 2–3 hour plan</span>\n+                    </div>\n                   </div>\n-                  <div className=\"flex gap-2\">\n-                    <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">2</span>\n-                    <span>Pick your vibe</span>\n+                </div>\n+                <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n+                  <div className=\"text-sm font-semibold\">Tips</div>\n+                  <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n+                    <div>• Use Park once for walkable areas.</div>\n+                    <div>• Tap Maps to open directions.</div>\n+                    <div>• Toggle Map to see pins.</div>\n                   </div>\n-                  <div className=\"flex gap-2\">\n-                    <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">3</span>\n-                    <span>Generate a 2–3 hour plan</span>\n-                  </div>\n                 </div>\n               </div>\n-              <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                <div className=\"text-sm font-semibold\">Tips</div>\n-                <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n-                  <div>• Use Park once for walkable areas.</div>\n-                  <div>• Tap Maps to open directions.</div>\n-                  <div>• Toggle Map to see pins.</div>\n-                </div>\n-              </div>\n             </div>\n+\n           </div>\n         </div>\n       </section>\n \n"
                },
                {
                    "date": 1766868758585,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -756,9 +756,24 @@\n                             />\n                           ) : null}\n \n                           <div className=\"min-w-0 flex-1\">\n-                            <div className=\"text-sm text-white/85\">{it.title}</div>\n+                            {it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\" ? (\n+                              <a\n+                                href={buildGoogleMapsToStopUrl({\n+                                  origin: userLoc,\n+                                  destination: { lat: it.lat, lng: it.lng },\n+                                  travelMode: plan?.parkOnce ? \"walking\" : \"driving\",\n+                                })}\n+                                target=\"_blank\"\n+                                rel=\"noreferrer\"\n+                                className=\"text-sm font-semibold text-white/90 hover:underline decoration-white/30\"\n+                              >\n+                                {it.title}\n+                              </a>\n+                            ) : (\n+                              <div className=\"text-sm text-white/85\">{it.title}</div>\n+                            )}\n                             {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n \n                             {it.type === \"stop\" ? (\n                               <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n"
                },
                {
                    "date": 1766870136703,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,7 @@\n \"use client\";\n \n import { useEffect, useMemo, useRef, useState } from \"react\";\n-\n import Script from \"next/script\";\n \n type PlanItem = {\n   type: \"stop\" | \"travel\";\n@@ -219,17 +218,20 @@\n   const markersRef = useRef<any[]>([]);\n   const directionsRef = useRef<any>(null);\n   const [loaded, setLoaded] = useState(false);\n \n-  const ready = loaded && typeof window !== \"undefined\" && (window as any).google?.maps;\n+  const ready =\n+    loaded && typeof window !== \"undefined\" && (window as any).google?.maps;\n \n   useEffect(() => {\n     if (!ready) return;\n     if (!mapDivRef.current) return;\n     if (mapRef.current) return;\n \n     const first = stops?.[0];\n-    const center = first ? { lat: first.lat, lng: first.lng } : { lat: 49.2827, lng: -123.1207 };\n+    const center = first\n+      ? { lat: first.lat, lng: first.lng }\n+      : { lat: 49.2827, lng: -123.1207 };\n \n     const g = (window as any).google;\n     mapRef.current = new g.maps.Map(mapDivRef.current, {\n       center,\n@@ -271,12 +273,14 @@\n         },\n       });\n \n       const info = new g.maps.InfoWindow({\n-        content: `<div style=\\\"font-size:13px; font-weight:600; padding:2px 0;\\\">${s.title}</div>`,\n+        content: `<div style=\"font-size:13px; font-weight:600; padding:2px 0;\">${s.title}</div>`,\n       });\n \n-      marker.addListener(\"click\", () => info.open({ map: mapRef.current!, anchor: marker }));\n+      marker.addListener(\"click\", () =>\n+        info.open({ map: mapRef.current!, anchor: marker })\n+      );\n \n       markersRef.current.push(marker);\n     });\n \n@@ -284,13 +288,22 @@\n   }, [loaded, ready, stops, origin]);\n \n   useEffect(() => {\n     if (!ready || !mapRef.current) return;\n-    if (!origin || origin.lat == null || origin.lng == null) return;\n     if (!stops || stops.length === 0) return;\n \n     const g = (window as any).google;\n \n+    const ptsAll = stops.map((s) => ({ lat: s.lat, lng: s.lng }));\n+    // If origin is unavailable, start from the first stop and route through the rest.\n+    const originPt =\n+      origin && origin.lat != null && origin.lng != null\n+        ? { lat: origin.lat, lng: origin.lng }\n+        : ptsAll[0];\n+    const pts =\n+      origin && origin.lat != null && origin.lng != null ? ptsAll : ptsAll.slice(1);\n+    if (pts.length === 0) return;\n+\n     // Clean up any previous renderer\n     if (directionsRef.current) {\n       try {\n         directionsRef.current.setMap(null);\n@@ -306,17 +319,19 @@\n \n     dr.setMap(mapRef.current);\n     directionsRef.current = dr;\n \n-    const mode = travelMode === \"WALKING\" ? g.maps.TravelMode.WALKING : g.maps.TravelMode.DRIVING;\n+    const mode =\n+      travelMode === \"WALKING\"\n+        ? g.maps.TravelMode.WALKING\n+        : g.maps.TravelMode.DRIVING;\n \n-    const pts = stops.map((s) => ({ lat: s.lat, lng: s.lng }));\n     const destination = pts[pts.length - 1];\n     const waypoints = pts.slice(0, -1).map((p) => ({ location: p, stopover: true }));\n \n     ds.route(\n       {\n-        origin: { lat: origin.lat, lng: origin.lng },\n+        origin: originPt,\n         destination,\n         waypoints,\n         travelMode: mode,\n         optimizeWaypoints: false,\n@@ -338,9 +353,12 @@\n   return (\n     <div className=\"mt-4 overflow-hidden rounded-2xl border border-white/10 bg-black/20\">\n       <div className=\"flex items-center justify-between border-b border-white/10 px-4 py-3\">\n         <div className=\"text-sm font-semibold text-white/85\">Map</div>\n-        <div className=\"text-xs text-white/55\">Stops: {stops.length}{origin ? \" + you\" : \"\"}</div>\n+        <div className=\"text-xs text-white/55\">\n+          Stops: {stops.length}\n+          {origin ? \" + you\" : \"\"}\n+        </div>\n       </div>\n       {!ready ? (\n         <div className=\"flex h-[360px] w-full items-center justify-center text-sm text-white/55\">\n           Loading map…\n@@ -367,8 +385,9 @@\n   const [error, setError] = useState<string | null>(null);\n   const [loading, setLoading] = useState(false);\n \n   const [parkOnce, setParkOnce] = useState(false);\n+  const [riderMode, setRiderMode] = useState(false);\n   const [showMap, setShowMap] = useState(true);\n   const [userLoc, setUserLoc] = useState<{ lat: number; lng: number } | null>(null);\n   const [locError, setLocError] = useState<string | null>(null);\n \n@@ -376,16 +395,20 @@\n \n   const mapStops = useMemo(() => {\n     if (!plan) return [] as { title: string; lat: number; lng: number }[];\n     return plan.items\n-      .filter((it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\")\n+      .filter(\n+        (it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\"\n+      )\n       .map((it) => ({ title: it.title, lat: it.lat as number, lng: it.lng as number }));\n   }, [plan]);\n \n   const routeStops = useMemo(() => {\n     if (!plan) return [] as { lat: number; lng: number }[];\n     return plan.items\n-      .filter((it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\")\n+      .filter(\n+        (it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\"\n+      )\n       .map((it) => ({ lat: it.lat as number, lng: it.lng as number }));\n   }, [plan]);\n \n   const cost = useMemo(() => (plan ? estimateCostRange(plan.items) : null), [plan]);\n@@ -424,13 +447,18 @@\n     setError(null);\n     setLoading(true);\n \n     try {\n-      // ✅ This was missing before: call your API route\n       const res = await fetch(\"/api/itinerary\", {\n         method: \"POST\",\n         headers: { \"Content-Type\": \"application/json\" },\n-        body: JSON.stringify({ destination: dest, totalMinutes: duration, vibe: style, parkOnce }),\n+        body: JSON.stringify({\n+          destination: dest,\n+          totalMinutes: duration,\n+          vibe: style,\n+          parkOnce,\n+          riderMode,\n+        }),\n       });\n \n       if (!res.ok) {\n         const txt = await res.text().catch(() => \"\");\n@@ -455,9 +483,8 @@\n     setDuration(150);\n     setError(null);\n     setPlan(null);\n \n-    // run after state updates\n     setTimeout(() => {\n       void onGenerate();\n     }, 0);\n   };\n@@ -492,9 +519,12 @@\n               type=\"button\"\n             >\n               Quick demo\n             </button>\n-            <button className=\"rounded-xl bg-white px-3 py-2 text-sm font-semibold text-black transition hover:bg-white/90\" type=\"button\">\n+            <button\n+              className=\"rounded-xl bg-white px-3 py-2 text-sm font-semibold text-black transition hover:bg-white/90\"\n+              type=\"button\"\n+            >\n               Sign in\n             </button>\n           </div>\n         </div>\n@@ -510,10 +540,13 @@\n             </div>\n \n             <h1 className=\"mt-4 text-4xl font-semibold tracking-tight sm:text-5xl\">\n               Build a\n-              <span className=\"bg-gradient-to-r from-fuchsia-300 via-sky-300 to-emerald-200 bg-clip-text text-transparent\"> 2–3 hour</span>\n-              {\" \"}itinerary\n+              <span className=\"bg-gradient-to-r from-fuchsia-300 via-sky-300 to-emerald-200 bg-clip-text text-transparent\">\n+                {\" \"}\n+                2–3 hour\n+              </span>{\" \"}\n+              itinerary\n             </h1>\n             <p className=\"mt-4 max-w-xl text-base text-white/70\">\n               Pick a destination, duration, and vibe. We’ll generate a tight plan you can actually follow.\n             </p>\n@@ -582,24 +615,44 @@\n                   })}\n                 </div>\n               </div>\n \n-            <div className=\"mt-3 flex flex-wrap items-center gap-2\">\n-              <button\n-                type=\"button\"\n-                onClick={() => setParkOnce((v) => !v)}\n-                className={\n-                  \"rounded-full px-3 py-1.5 text-sm transition \" +\n-                  (parkOnce\n-                    ? \"bg-white text-black\"\n-                    : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n-                }\n-              >\n-                {parkOnce ? \"Park once: ON\" : \"Park once\"}\n-              </button>\n-              <div className=\"text-xs text-white/55\">Park near the first stop, then walk between stops.</div>\n-            </div>\n+              <div className=\"mt-4 flex flex-col gap-2\">\n+                <button\n+                  type=\"button\"\n+                  onClick={() => setParkOnce((v) => !v)}\n+                  className={\n+                    \"self-start rounded-full px-3 py-1.5 text-sm transition \" +\n+                    (parkOnce\n+                      ? \"bg-white text-black\"\n+                      : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                  }\n+                >\n+                  {parkOnce ? \"Park once: ON\" : \"Park once\"}\n+                </button>\n \n+                <button\n+                  type=\"button\"\n+                  onClick={() => setRiderMode((v) => !v)}\n+                  className={\n+                    \"self-start rounded-full px-3 py-1.5 text-sm transition \" +\n+                    (riderMode\n+                      ? \"bg-white text-black\"\n+                      : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                  }\n+                >\n+                  {riderMode ? \"Rider mode: ON\" : \"Rider mode\"}\n+                </button>\n+\n+                <div className=\"text-xs text-white/55\">\n+                  {parkOnce ? \"Park near the first stop, then walk between stops. \" : \" \"}\n+                  {riderMode ? \"More scenic stops, easier pull-ins, loop-friendly ordering.\" : \"\"}\n+                  {!parkOnce && !riderMode\n+                    ? \"Park near the first stop (optional), or enable Rider mode for scenic stops.\"\n+                    : null}\n+                </div>\n+              </div>\n+\n               <div className=\"mt-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n                 <div className=\"text-sm\">\n                   {error ? (\n                     <span className=\"text-rose-300\">{error}</span>\n@@ -661,9 +714,11 @@\n                       </a>\n                     </div>\n                   </div>\n \n-                  {locError ? <div className=\"mt-2 text-xs text-rose-200/90\">{locError}</div> : null}\n+                  {locError ? (\n+                    <div className=\"mt-2 text-xs text-rose-200/90\">{locError}</div>\n+                  ) : null}\n \n                   {showMap ? (\n                     mapsKey ? (\n                       <MapView\n@@ -673,9 +728,10 @@\n                         travelMode={parkOnce ? \"WALKING\" : \"DRIVING\"}\n                       />\n                     ) : (\n                       <div className=\"mt-3 rounded-2xl border border-amber-400/20 bg-amber-400/10 p-4 text-sm text-amber-100\">\n-                        Map view needs <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n+                        Map view needs{\" \"}\n+                        <span className=\"font-semibold\">NEXT_PUBLIC_GOOGLE_MAPS_API_KEY</span> in your env.\n                         <div className=\"mt-1 text-xs text-amber-100/80\">\n                           Add it to <code>.env.local</code> and Vercel env vars, then restart.\n                         </div>\n                       </div>\n@@ -694,11 +750,19 @@\n                     <div className=\"mt-1 text-lg font-semibold\">Your itinerary</div>\n                     <div className=\"mt-1 text-sm text-white/60\">\n                       {plan ? (\n                         <>\n-                          {plan.destination || \"—\"} • {plan.totalMinutes} min • {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n+                          {plan.destination || \"—\"} • {plan.totalMinutes} min •{\" \"}\n+                          {TRAVEL_STYLES.find((s) => s.key === style)?.label}\n                           {plan.items?.some(\n-                            (x) => x.type === \"stop\" && (x.photoUrl || x.rating || x.priceLevel || x.openNow !== undefined || x.reviewSnippet || x.parking)\n+                            (x) =>\n+                              x.type === \"stop\" &&\n+                              (x.photoUrl ||\n+                                x.rating ||\n+                                x.priceLevel ||\n+                                x.openNow !== undefined ||\n+                                x.reviewSnippet ||\n+                                x.parking)\n                           ) ? (\n                             <span className=\"ml-2 rounded-full border border-emerald-400/30 bg-emerald-400/10 px-2 py-0.5 text-xs text-emerald-200\">\n                               Enriched\n                             </span>\n@@ -706,8 +770,15 @@\n                             <span className=\"ml-2 rounded-full border border-rose-400/30 bg-rose-400/10 px-2 py-0.5 text-xs text-rose-200\">\n                               Basic\n                             </span>\n                           )}\n+\n+                          {riderMode ? (\n+                            <span className=\"ml-2 rounded-full border border-sky-400/30 bg-sky-400/10 px-2 py-0.5 text-xs text-sky-200\">\n+                              Rider Mode\n+                            </span>\n+                          ) : null}\n+\n                           {cost ? (\n                             <span className=\"ml-2 rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-xs text-white/80\">\n                               Est. ${cost.min}–${cost.max}\n                             </span>\n@@ -734,14 +805,20 @@\n                       <div\n                         key={idx}\n                         className={\n                           \"rounded-2xl border border-white/12 p-4 transition \" +\n-                          (it.type === \"stop\" ? \"bg-black/20 hover:bg-black/25\" : \"bg-white/5 hover:bg-white/10\")\n+                          (it.type === \"stop\"\n+                            ? \"bg-black/20 hover:bg-black/25\"\n+                            : \"bg-white/5 hover:bg-white/10\")\n                         }\n                       >\n                         <div className=\"flex items-center justify-between gap-3\">\n                           <div className=\"text-sm font-semibold\">\n-                            {it.type === \"stop\" ? \"Stop\" : it.mode === \"WALK\" ? \"Walk\" : \"Drive\"}\n+                            {it.type === \"stop\"\n+                              ? \"Stop\"\n+                              : it.mode === \"WALK\"\n+                              ? \"Walk\"\n+                              : \"Drive\"}\n                           </div>\n                           <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                         </div>\n \n@@ -756,9 +833,11 @@\n                             />\n                           ) : null}\n \n                           <div className=\"min-w-0 flex-1\">\n-                            {it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\" ? (\n+                            {it.type === \"stop\" &&\n+                            typeof it.lat === \"number\" &&\n+                            typeof it.lng === \"number\" ? (\n                               <a\n                                 href={buildGoogleMapsToStopUrl({\n                                   origin: userLoc,\n                                   destination: { lat: it.lat, lng: it.lng },\n@@ -772,10 +851,13 @@\n                               </a>\n                             ) : (\n                               <div className=\"text-sm text-white/85\">{it.title}</div>\n                             )}\n-                            {it.address ? <div className=\"mt-1 text-xs text-white/55\">{it.address}</div> : null}\n \n+                            {it.address ? (\n+                              <div className=\"mt-1 text-xs text-white/55\">{it.address}</div>\n+                            ) : null}\n+\n                             {it.type === \"stop\" ? (\n                               <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs\">\n                                 {formatRating(it.rating, it.userRatingCount) ? (\n                                   <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-white/80\">\n@@ -861,45 +943,58 @@\n                 <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n                   <div className=\"text-sm font-semibold\">How it works</div>\n                   <div className=\"mt-2 space-y-2 text-sm text-white/70\">\n                     <div className=\"flex gap-2\">\n-                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">1</span>\n+                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">\n+                        1\n+                      </span>\n                       <span>Destination + duration</span>\n                     </div>\n                     <div className=\"flex gap-2\">\n-                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">2</span>\n+                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">\n+                        2\n+                      </span>\n                       <span>Pick your vibe</span>\n                     </div>\n                     <div className=\"flex gap-2\">\n-                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">3</span>\n+                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">\n+                        3\n+                      </span>\n                       <span>Generate a 2–3 hour plan</span>\n                     </div>\n                   </div>\n                 </div>\n                 <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n                   <div className=\"text-sm font-semibold\">Tips</div>\n                   <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n                     <div>• Use Park once for walkable areas.</div>\n+                    <div>• Rider mode prefers scenic stops.</div>\n                     <div>• Tap Maps to open directions.</div>\n-                    <div>• Toggle Map to see pins.</div>\n                   </div>\n                 </div>\n               </div>\n             </div>\n-\n           </div>\n         </div>\n       </section>\n \n       <footer className=\"mx-auto max-w-6xl px-4 pb-10 pt-2 text-sm text-white/45\">\n         <div className=\"flex flex-col gap-2 border-t border-white/10 pt-6 sm:flex-row sm:items-center sm:justify-between\">\n-          <div>© {new Date().getFullYear()} {APP_NAME}</div>\n+          <div>\n+            © {new Date().getFullYear()} {APP_NAME}\n+          </div>\n           <div className=\"flex gap-4\">\n-            <button className=\"hover:text-white/70\" type=\"button\">Privacy</button>\n-            <button className=\"hover:text-white/70\" type=\"button\">Terms</button>\n-            <button className=\"hover:text-white/70\" type=\"button\">Contact</button>\n+            <button className=\"hover:text-white/70\" type=\"button\">\n+              Privacy\n+            </button>\n+            <button className=\"hover:text-white/70\" type=\"button\">\n+              Terms\n+            </button>\n+            <button className=\"hover:text-white/70\" type=\"button\">\n+              Contact\n+            </button>\n           </div>\n         </div>\n       </footer>\n     </main>\n   );\n-}\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1766870829029,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,8 +32,10 @@\n   destination: string;\n   totalMinutes: number;\n   vibe: string;\n   parkOnce?: boolean;\n+  riderMode?: boolean;\n+  bufferMinutes?: number;\n   items: PlanItem[];\n };\n \n const APP_NAME = \"Wander App\";\n@@ -49,9 +51,8 @@\n \n type TravelStyleKey = (typeof TRAVEL_STYLES)[number][\"key\"];\n \n function formatPriceLevel(priceLevel?: string) {\n-  // Typical values: PRICE_LEVEL_FREE, PRICE_LEVEL_INEXPENSIVE, ...\n   if (!priceLevel) return undefined;\n   if (priceLevel.includes(\"FREE\")) return \"Free\";\n   if (priceLevel.includes(\"INEXPENSIVE\")) return \"$\";\n   if (priceLevel.includes(\"MODERATE\")) return \"$$\";\n@@ -111,10 +112,8 @@\n   return `https://www.google.com/maps/dir/?${params.toString()}`;\n }\n \n function estimateCostRange(items: PlanItem[]) {\n-  // very rough per-stop estimates (USD)\n-  // Free: 0-0, $: 10-25, $$: 25-60, $$$: 60-120, $$$$: 120-250\n   const stopItems = items.filter((x) => x.type === \"stop\");\n   if (stopItems.length === 0) return null;\n \n   let min = 0;\n@@ -137,15 +136,13 @@\n     } else if (pl.includes(\"VERY_EXPENSIVE\")) {\n       min += 120;\n       max += 250;\n     } else {\n-      // unknown: assume low-to-mid\n       min += 10;\n       max += 60;\n     }\n   }\n \n-  // Add small buffer for transport/parking etc.\n   min += 5;\n   max += 20;\n \n   return { min, max };\n@@ -239,9 +236,9 @@\n       mapTypeControl: false,\n       fullscreenControl: false,\n       streetViewControl: false,\n     });\n-  }, [loaded, ready, stops, origin]);\n+  }, [loaded, ready, stops]);\n \n   useEffect(() => {\n     if (!ready) return;\n     if (!mapRef.current) return;\n@@ -293,18 +290,16 @@\n \n     const g = (window as any).google;\n \n     const ptsAll = stops.map((s) => ({ lat: s.lat, lng: s.lng }));\n-    // If origin is unavailable, start from the first stop and route through the rest.\n     const originPt =\n       origin && origin.lat != null && origin.lng != null\n         ? { lat: origin.lat, lng: origin.lng }\n         : ptsAll[0];\n     const pts =\n       origin && origin.lat != null && origin.lng != null ? ptsAll : ptsAll.slice(1);\n     if (pts.length === 0) return;\n \n-    // Clean up any previous renderer\n     if (directionsRef.current) {\n       try {\n         directionsRef.current.setMap(null);\n       } catch {}\n@@ -386,8 +381,10 @@\n   const [loading, setLoading] = useState(false);\n \n   const [parkOnce, setParkOnce] = useState(false);\n   const [riderMode, setRiderMode] = useState(false);\n+  const [addBuffer, setAddBuffer] = useState(false);\n+\n   const [showMap, setShowMap] = useState(true);\n   const [userLoc, setUserLoc] = useState<{ lat: number; lng: number } | null>(null);\n   const [locError, setLocError] = useState<string | null>(null);\n \n@@ -456,8 +453,9 @@\n           totalMinutes: duration,\n           vibe: style,\n           parkOnce,\n           riderMode,\n+          bufferMinutes: addBuffer ? 10 : 0,\n         }),\n       });\n \n       if (!res.ok) {\n@@ -642,13 +640,27 @@\n                 >\n                   {riderMode ? \"Rider mode: ON\" : \"Rider mode\"}\n                 </button>\n \n+                <button\n+                  type=\"button\"\n+                  onClick={() => setAddBuffer((v) => !v)}\n+                  className={\n+                    \"self-start rounded-full px-3 py-1.5 text-sm transition \" +\n+                    (addBuffer\n+                      ? \"bg-white text-black\"\n+                      : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                  }\n+                >\n+                  {addBuffer ? \"Buffer: +10 min\" : \"Add buffer\"}\n+                </button>\n+\n                 <div className=\"text-xs text-white/55\">\n-                  {parkOnce ? \"Park near the first stop, then walk between stops. \" : \" \"}\n-                  {riderMode ? \"More scenic stops, easier pull-ins, loop-friendly ordering.\" : \"\"}\n-                  {!parkOnce && !riderMode\n-                    ? \"Park near the first stop (optional), or enable Rider mode for scenic stops.\"\n+                  {parkOnce ? \"Park near the first stop, then walk between stops. \" : \"\"}\n+                  {riderMode ? \"More scenic stops, easier pull-ins, loop-friendly ordering. \" : \"\"}\n+                  {addBuffer ? \"Adds +10 min buffer to each travel leg for parking/traffic.\" : \"\"}\n+                  {!parkOnce && !riderMode && !addBuffer\n+                    ? \"Optional: Park once for walkable clusters, Rider mode for scenic stops, and Buffer for realism.\"\n                     : null}\n                 </div>\n               </div>\n \n@@ -740,9 +752,9 @@\n                 </div>\n               ) : null}\n             </div>\n \n-            {/* preview (moved below planner) */}\n+            {/* preview */}\n             <div className=\"mt-8\">\n               <div className=\"rounded-3xl border border-white/12 bg-white/5 p-5 shadow-[0_0_0_1px_rgba(255,255,255,0.06)] backdrop-blur\">\n                 <div className=\"flex items-start justify-between gap-3\">\n                   <div>\n@@ -777,8 +789,14 @@\n                               Rider Mode\n                             </span>\n                           ) : null}\n \n+                          {plan?.bufferMinutes ? (\n+                            <span className=\"ml-2 rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-xs text-white/80\">\n+                              Buffer +{plan.bufferMinutes}m/leg\n+                            </span>\n+                          ) : null}\n+\n                           {cost ? (\n                             <span className=\"ml-2 rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-xs text-white/80\">\n                               Est. ${cost.min}–${cost.max}\n                             </span>\n@@ -937,42 +955,8 @@\n                     </div>\n                   </div>\n                 )}\n               </div>\n-\n-              <div className=\"mt-4 grid gap-3 sm:grid-cols-2\">\n-                <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                  <div className=\"text-sm font-semibold\">How it works</div>\n-                  <div className=\"mt-2 space-y-2 text-sm text-white/70\">\n-                    <div className=\"flex gap-2\">\n-                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">\n-                        1\n-                      </span>\n-                      <span>Destination + duration</span>\n-                    </div>\n-                    <div className=\"flex gap-2\">\n-                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">\n-                        2\n-                      </span>\n-                      <span>Pick your vibe</span>\n-                    </div>\n-                    <div className=\"flex gap-2\">\n-                      <span className=\"grid h-6 w-6 place-items-center rounded-lg bg-white/10 text-xs ring-1 ring-white/10\">\n-                        3\n-                      </span>\n-                      <span>Generate a 2–3 hour plan</span>\n-                    </div>\n-                  </div>\n-                </div>\n-                <div className=\"rounded-2xl border border-white/12 bg-white/5 p-4\">\n-                  <div className=\"text-sm font-semibold\">Tips</div>\n-                  <div className=\"mt-2 space-y-1 text-sm text-white/70\">\n-                    <div>• Use Park once for walkable areas.</div>\n-                    <div>• Rider mode prefers scenic stops.</div>\n-                    <div>• Tap Maps to open directions.</div>\n-                  </div>\n-                </div>\n-              </div>\n             </div>\n           </div>\n         </div>\n       </section>\n"
                },
                {
                    "date": 1766871976952,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,9 @@\n \n type PlanItem = {\n   type: \"stop\" | \"travel\";\n   title: string;\n+  placeId?: string; // ✅ added for swap\n   durationMin: number;\n   mode?: \"DRIVE\" | \"WALK\";\n   lat?: number;\n   lng?: number;\n@@ -37,8 +38,13 @@\n   bufferMinutes?: number;\n   items: PlanItem[];\n };\n \n+type ScheduledPlanItem = PlanItem & {\n+  start: Date;\n+  end: Date;\n+};\n+\n const APP_NAME = \"Wander App\";\n \n type DurationKey = 120 | 150 | 180;\n \n@@ -147,8 +153,21 @@\n \n   return { min, max };\n }\n \n+function formatTime(d: Date) {\n+  try {\n+    return new Intl.DateTimeFormat(undefined, {\n+      hour: \"2-digit\",\n+      minute: \"2-digit\",\n+    }).format(d);\n+  } catch {\n+    const hh = String(d.getHours()).padStart(2, \"0\");\n+    const mm = String(d.getMinutes()).padStart(2, \"0\");\n+    return `${hh}:${mm}`;\n+  }\n+}\n+\n function IconSparkle(props: { className?: string }) {\n   return (\n     <svg\n       className={props.className}\n@@ -379,12 +398,17 @@\n   const [plan, setPlan] = useState<PlanResponse | null>(null);\n   const [error, setError] = useState<string | null>(null);\n   const [loading, setLoading] = useState(false);\n \n+  const [swappingIdx, setSwappingIdx] = useState<number | null>(null); // ✅ added\n+\n   const [parkOnce, setParkOnce] = useState(false);\n   const [riderMode, setRiderMode] = useState(false);\n   const [addBuffer, setAddBuffer] = useState(false);\n \n+  const [startMode, setStartMode] = useState<\"now\" | \"custom\">(\"now\");\n+  const [startClock, setStartClock] = useState(\"10:00\");\n+\n   const [showMap, setShowMap] = useState(true);\n   const [userLoc, setUserLoc] = useState<{ lat: number; lng: number } | null>(null);\n   const [locError, setLocError] = useState<string | null>(null);\n \n@@ -409,8 +433,31 @@\n   }, [plan]);\n \n   const cost = useMemo(() => (plan ? estimateCostRange(plan.items) : null), [plan]);\n \n+  const scheduledItems = useMemo((): ScheduledPlanItem[] => {\n+    if (!plan) return [];\n+\n+    const base = new Date();\n+    let cursor = new Date(base);\n+\n+    if (startMode === \"custom\") {\n+      const parts = String(startClock || \"\").split(\":\");\n+      const hh = Number(parts[0]);\n+      const mm = Number(parts[1]);\n+      if (Number.isFinite(hh) && Number.isFinite(mm)) {\n+        cursor.setHours(hh, mm, 0, 0);\n+      }\n+    }\n+\n+    return plan.items.map((item) => {\n+      const start = new Date(cursor);\n+      const end = new Date(cursor.getTime() + (item.durationMin || 0) * 60_000);\n+      cursor = end;\n+      return { ...item, start, end };\n+    });\n+  }, [plan, startMode, startClock]);\n+\n   async function captureMyLocation() {\n     setLocError(null);\n     if (typeof window === \"undefined\" || !navigator?.geolocation) {\n       setLocError(\"Geolocation not available in this browser.\");\n@@ -474,8 +521,66 @@\n       setLoading(false);\n     }\n   };\n \n+  // ✅ Swap stop handler\n+  const onSwapStop = async (stopIdxInStops: number) => {\n+    if (!plan) return;\n+\n+    const stopsOnly = plan.items\n+      .filter((x) => x.type === \"stop\")\n+      .map((s) => ({\n+        placeId: (s as any).placeId,\n+        title: s.title,\n+        durationMin: s.durationMin,\n+        lat: s.lat,\n+        lng: s.lng,\n+      }));\n+\n+    const target = stopsOnly[stopIdxInStops];\n+    if (!target?.placeId || typeof target.lat !== \"number\" || typeof target.lng !== \"number\") {\n+      setError(\"Swap not available for this stop (missing placeId or location). Regenerate once.\");\n+      return;\n+    }\n+\n+    setError(null);\n+    setSwappingIdx(stopIdxInStops);\n+\n+    try {\n+      const res = await fetch(\"/api/itinerary\", {\n+        method: \"POST\",\n+        headers: { \"Content-Type\": \"application/json\" },\n+        body: JSON.stringify({\n+          action: \"swap\",\n+          destination: plan.destination,\n+          totalMinutes: plan.totalMinutes,\n+          vibe: style,\n+          parkOnce,\n+          riderMode,\n+          bufferMinutes: addBuffer ? 10 : 0,\n+          stops: stopsOnly,\n+          swapIndex: stopIdxInStops,\n+          swapPlaceId: target.placeId,\n+          swapLat: target.lat,\n+          swapLng: target.lng,\n+        }),\n+      });\n+\n+      if (!res.ok) {\n+        const txt = await res.text().catch(() => \"\");\n+        throw new Error(txt || \"Swap failed\");\n+      }\n+\n+      const data = (await res.json()) as PlanResponse;\n+      setPlan(data);\n+    } catch (e) {\n+      const msg = e instanceof Error ? e.message : \"Swap failed\";\n+      setError(msg);\n+    } finally {\n+      setSwappingIdx(null);\n+    }\n+  };\n+\n   const onQuickDemo = () => {\n     setDestination(\"Vancouver\");\n     setStyle(\"culture\");\n     setDuration(150);\n@@ -663,8 +768,64 @@\n                     : null}\n                 </div>\n               </div>\n \n+              <div className=\"mt-4 rounded-xl border border-white/10 bg-black/20 px-3 py-3\">\n+                <div className=\"flex flex-wrap items-center justify-between gap-3\">\n+                  <div>\n+                    <div className=\"text-xs text-white/60\">Schedule</div>\n+                    <div className=\"mt-0.5 text-sm font-semibold text-white/85\">Start time</div>\n+                  </div>\n+\n+                  <div className=\"flex flex-wrap items-center gap-2\">\n+                    <button\n+                      type=\"button\"\n+                      onClick={() => setStartMode(\"now\")}\n+                      className={\n+                        \"rounded-full px-3 py-1.5 text-sm transition \" +\n+                        (startMode === \"now\"\n+                          ? \"bg-white text-black\"\n+                          : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                      }\n+                    >\n+                      Now\n+                    </button>\n+\n+                    <button\n+                      type=\"button\"\n+                      onClick={() => setStartMode(\"custom\")}\n+                      className={\n+                        \"rounded-full px-3 py-1.5 text-sm transition \" +\n+                        (startMode === \"custom\"\n+                          ? \"bg-white text-black\"\n+                          : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n+                      }\n+                    >\n+                      Choose time\n+                    </button>\n+\n+                    <input\n+                      type=\"time\"\n+                      value={startClock}\n+                      onChange={(e) => {\n+                        setStartClock(e.target.value);\n+                        setStartMode(\"custom\");\n+                      }}\n+                      className={\n+                        \"rounded-xl border px-3 py-2 text-sm outline-none transition \" +\n+                        (startMode === \"custom\"\n+                          ? \"border-white/25 bg-black/30 text-white\"\n+                          : \"border-white/10 bg-black/20 text-white/60\")\n+                      }\n+                    />\n+                  </div>\n+                </div>\n+\n+                <div className=\"mt-2 text-xs text-white/55\">\n+                  Shows real start/end times for each drive/walk and stop.\n+                </div>\n+              </div>\n+\n               <div className=\"mt-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n                 <div className=\"text-sm\">\n                   {error ? (\n                     <span className=\"text-rose-300\">{error}</span>\n@@ -818,9 +979,9 @@\n                 </div>\n \n                 {plan ? (\n                   <div className=\"mt-4 grid gap-3\">\n-                    {plan.items.map((it, idx) => (\n+                    {scheduledItems.map((it, idx) => (\n                       <div\n                         key={idx}\n                         className={\n                           \"rounded-2xl border border-white/12 p-4 transition \" +\n@@ -828,17 +989,50 @@\n                             ? \"bg-black/20 hover:bg-black/25\"\n                             : \"bg-white/5 hover:bg-white/10\")\n                         }\n                       >\n-                        <div className=\"flex items-center justify-between gap-3\">\n-                          <div className=\"text-sm font-semibold\">\n-                            {it.type === \"stop\"\n-                              ? \"Stop\"\n-                              : it.mode === \"WALK\"\n-                              ? \"Walk\"\n-                              : \"Drive\"}\n+                        <div className=\"flex items-start justify-between gap-3\">\n+                          <div>\n+                            <div className=\"text-sm font-semibold\">\n+                              {it.type === \"stop\"\n+                                ? \"Stop\"\n+                                : it.mode === \"WALK\"\n+                                ? \"Walk\"\n+                                : \"Drive\"}\n+                            </div>\n+                            <div className=\"mt-0.5 text-xs text-white/55\">\n+                              {formatTime(it.start)} – {formatTime(it.end)}\n+                            </div>\n                           </div>\n-                          <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n+\n+                          {/* ✅ Swap + duration */}\n+                          <div className=\"flex items-center gap-2\">\n+                            {it.type === \"stop\" ? (\n+                              <button\n+                                type=\"button\"\n+                                onClick={() => {\n+                                  const stopIndex =\n+                                    scheduledItems.slice(0, idx + 1).filter((x) => x.type === \"stop\")\n+                                      .length - 1;\n+                                  void onSwapStop(stopIndex);\n+                                }}\n+                                disabled={swappingIdx !== null}\n+                                className={\n+                                  \"rounded-full px-2 py-1 text-xs transition \" +\n+                                  (swappingIdx !== null\n+                                    ? \"border border-white/10 bg-white/5 text-white/45\"\n+                                    : \"border border-white/15 bg-white/5 text-white/80 hover:bg-white/10\")\n+                                }\n+                              >\n+                                {swappingIdx ===\n+                                scheduledItems.slice(0, idx + 1).filter((x) => x.type === \"stop\")\n+                                  .length - 1\n+                                  ? \"Swapping…\"\n+                                  : \"Swap\"}\n+                              </button>\n+                            ) : null}\n+                            <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n+                          </div>\n                         </div>\n \n                         <div className=\"mt-2 flex gap-3\">\n                           {it.type === \"stop\" && it.photoUrl ? (\n"
                },
                {
                    "date": 1766873171317,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -339,9 +339,11 @@\n         ? g.maps.TravelMode.WALKING\n         : g.maps.TravelMode.DRIVING;\n \n     const destination = pts[pts.length - 1];\n-    const waypoints = pts.slice(0, -1).map((p) => ({ location: p, stopover: true }));\n+    const waypoints = pts\n+      .slice(0, -1)\n+      .map((p) => ({ location: p, stopover: true }));\n \n     ds.route(\n       {\n         origin: originPt,\n@@ -372,15 +374,19 @@\n           Stops: {stops.length}\n           {origin ? \" + you\" : \"\"}\n         </div>\n       </div>\n+\n       {!ready ? (\n         <div className=\"flex h-[360px] w-full items-center justify-center text-sm text-white/55\">\n           Loading map…\n         </div>\n       ) : null}\n \n-      <div ref={mapDivRef} className={\"w-full \" + (ready ? \"h-[360px]\" : \"h-0\")} />\n+      <div\n+        ref={mapDivRef}\n+        className={\"w-full \" + (ready ? \"h-[360px]\" : \"h-0\")}\n+      />\n \n       <Script\n         id=\"google-maps-js\"\n         src={`https://maps.googleapis.com/maps/api/js?key=${apiKey}`}\n@@ -408,32 +414,47 @@\n   const [startMode, setStartMode] = useState<\"now\" | \"custom\">(\"now\");\n   const [startClock, setStartClock] = useState(\"10:00\");\n \n   const [showMap, setShowMap] = useState(true);\n-  const [userLoc, setUserLoc] = useState<{ lat: number; lng: number } | null>(null);\n+  const [userLoc, setUserLoc] = useState<{ lat: number; lng: number } | null>(\n+    null\n+  );\n   const [locError, setLocError] = useState<string | null>(null);\n \n   const mapsKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || \"\";\n \n   const mapStops = useMemo(() => {\n     if (!plan) return [] as { title: string; lat: number; lng: number }[];\n     return plan.items\n       .filter(\n-        (it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\"\n+        (it) =>\n+          it.type === \"stop\" &&\n+          typeof it.lat === \"number\" &&\n+          typeof it.lng === \"number\"\n       )\n-      .map((it) => ({ title: it.title, lat: it.lat as number, lng: it.lng as number }));\n+      .map((it) => ({\n+        title: it.title,\n+        lat: it.lat as number,\n+        lng: it.lng as number,\n+      }));\n   }, [plan]);\n \n   const routeStops = useMemo(() => {\n     if (!plan) return [] as { lat: number; lng: number }[];\n     return plan.items\n       .filter(\n-        (it) => it.type === \"stop\" && typeof it.lat === \"number\" && typeof it.lng === \"number\"\n+        (it) =>\n+          it.type === \"stop\" &&\n+          typeof it.lat === \"number\" &&\n+          typeof it.lng === \"number\"\n       )\n       .map((it) => ({ lat: it.lat as number, lng: it.lng as number }));\n   }, [plan]);\n \n-  const cost = useMemo(() => (plan ? estimateCostRange(plan.items) : null), [plan]);\n+  const cost = useMemo(\n+    () => (plan ? estimateCostRange(plan.items) : null),\n+    [plan]\n+  );\n \n   const scheduledItems = useMemo((): ScheduledPlanItem[] => {\n     if (!plan) return [];\n \n@@ -528,18 +549,27 @@\n \n     const stopsOnly = plan.items\n       .filter((x) => x.type === \"stop\")\n       .map((s) => ({\n-        placeId: (s as any).placeId,\n+        placeId: s.placeId,\n         title: s.title,\n         durationMin: s.durationMin,\n         lat: s.lat,\n         lng: s.lng,\n-      }));\n+      }))\n+      .filter(\n+        (s) =>\n+          typeof s.placeId === \"string\" &&\n+          s.placeId.length > 0 &&\n+          typeof s.lat === \"number\" &&\n+          typeof s.lng === \"number\"\n+      );\n \n     const target = stopsOnly[stopIdxInStops];\n     if (!target?.placeId || typeof target.lat !== \"number\" || typeof target.lng !== \"number\") {\n-      setError(\"Swap not available for this stop (missing placeId or location). Regenerate once.\");\n+      setError(\n+        \"Swap isn’t available for this stop yet (missing Google placeId or coordinates). Please Generate again.\"\n+      );\n       return;\n     }\n \n     setError(null);\n@@ -888,9 +918,11 @@\n                     </div>\n                   </div>\n \n                   {locError ? (\n-                    <div className=\"mt-2 text-xs text-rose-200/90\">{locError}</div>\n+                    <div className=\"mt-2 text-xs text-rose-200/90\">\n+                      {locError} You can still open routes—starting point will default to the first stop.\n+                    </div>\n                   ) : null}\n \n                   {showMap ? (\n                     mapsKey ? (\n@@ -1006,30 +1038,35 @@\n \n                           {/* ✅ Swap + duration */}\n                           <div className=\"flex items-center gap-2\">\n                             {it.type === \"stop\" ? (\n-                              <button\n-                                type=\"button\"\n-                                onClick={() => {\n-                                  const stopIndex =\n-                                    scheduledItems.slice(0, idx + 1).filter((x) => x.type === \"stop\")\n-                                      .length - 1;\n-                                  void onSwapStop(stopIndex);\n-                                }}\n-                                disabled={swappingIdx !== null}\n-                                className={\n-                                  \"rounded-full px-2 py-1 text-xs transition \" +\n-                                  (swappingIdx !== null\n-                                    ? \"border border-white/10 bg-white/5 text-white/45\"\n-                                    : \"border border-white/15 bg-white/5 text-white/80 hover:bg-white/10\")\n-                                }\n-                              >\n-                                {swappingIdx ===\n-                                scheduledItems.slice(0, idx + 1).filter((x) => x.type === \"stop\")\n-                                  .length - 1\n-                                  ? \"Swapping…\"\n-                                  : \"Swap\"}\n-                              </button>\n+                              <>\n+                                {(() => {\n+                                  const currentStopIndex =\n+                                    scheduledItems\n+                                      .slice(0, idx + 1)\n+                                      .filter((x) => x.type === \"stop\").length - 1;\n+                                  const isThisSwapping = swappingIdx === currentStopIndex;\n+\n+                                  return (\n+                                    <button\n+                                      type=\"button\"\n+                                      onClick={() => {\n+                                        void onSwapStop(currentStopIndex);\n+                                      }}\n+                                      disabled={isThisSwapping}\n+                                      className={\n+                                        \"rounded-full px-2 py-1 text-xs transition \" +\n+                                        (isThisSwapping\n+                                          ? \"border border-white/10 bg-white/5 text-white/45\"\n+                                          : \"border border-white/15 bg-white/5 text-white/80 hover:bg-white/10\")\n+                                      }\n+                                    >\n+                                      {isThisSwapping ? \"Swapping…\" : \"Swap\"}\n+                                    </button>\n+                                  );\n+                                })()}\n+                              </>\n                             ) : null}\n                             <div className=\"text-xs text-white/55\">{it.durationMin} min</div>\n                           </div>\n                         </div>\n@@ -1121,9 +1158,11 @@\n                               <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n                                 <div className=\"text-xs font-semibold text-white/80\">Parking</div>\n                                 <div className=\"mt-1 text-xs text-white/70\">{it.parking.name}</div>\n                                 {it.parking.address ? (\n-                                  <div className=\"mt-0.5 text-xs text-white/55\">{it.parking.address}</div>\n+                                  <div className=\"mt-0.5 text-xs text-white/55\">\n+                                    {it.parking.address}\n+                                  </div>\n                                 ) : null}\n                                 {it.parking.mapsUri ? (\n                                   <a\n                                     href={it.parking.mapsUri}\n"
                },
                {
                    "date": 1766873395246,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,20 +175,42 @@\n       fill=\"none\"\n       xmlns=\"http://www.w3.org/2000/svg\"\n       aria-hidden=\"true\"\n     >\n+      {/* Compass ring */}\n       <path\n-        d=\"M12 2l1.1 5.2L18 9l-4.9 1.8L12 16l-1.1-5.2L6 9l4.9-1.8L12 2z\"\n+        d=\"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z\"\n         stroke=\"currentColor\"\n-        strokeWidth=\"1.5\"\n-        strokeLinejoin=\"round\"\n+        strokeWidth=\"1.6\"\n+        opacity=\"0.9\"\n       />\n+      {/* Cardinal ticks */}\n       <path\n-        d=\"M19 13l.7 3.2 3.3.8-3.3.8L19 21l-.7-3.2-3.3-.8 3.3-.8L19 13z\"\n+        d=\"M12 3.5v2.2M12 18.3v2.2M3.5 12h2.2M18.3 12h2.2\"\n         stroke=\"currentColor\"\n-        strokeWidth=\"1.5\"\n+        strokeWidth=\"1.6\"\n+        strokeLinecap=\"round\"\n+        opacity=\"0.6\"\n+      />\n+      {/* Needle */}\n+      <path\n+        d=\"M14.9 9.1 13 13l-3.9 1.9L11 11l3.9-1.9Z\"\n+        fill=\"currentColor\"\n+        opacity=\"0.9\"\n+      />\n+      <path\n+        d=\"M14.9 9.1 13 13l-3.9 1.9L11 11l3.9-1.9Z\"\n+        stroke=\"currentColor\"\n+        strokeWidth=\"1.2\"\n         strokeLinejoin=\"round\"\n+        opacity=\"0.9\"\n       />\n+      {/* Center dot */}\n+      <path\n+        d=\"M12 12.1a.9.9 0 1 0 0-1.8.9.9 0 0 0 0 1.8Z\"\n+        fill=\"currentColor\"\n+        opacity=\"0.9\"\n+      />\n     </svg>\n   );\n }\n \n@@ -217,8 +239,79 @@\n     </svg>\n   );\n }\n \n+function IconCheck(props: { className?: string }) {\n+  return (\n+    <svg\n+      className={props.className}\n+      viewBox=\"0 0 24 24\"\n+      fill=\"none\"\n+      xmlns=\"http://www.w3.org/2000/svg\"\n+      aria-hidden=\"true\"\n+    >\n+      <path\n+        d=\"M20 6L9 17l-5-5\"\n+        stroke=\"currentColor\"\n+        strokeWidth=\"1.8\"\n+        strokeLinecap=\"round\"\n+        strokeLinejoin=\"round\"\n+      />\n+    </svg>\n+  );\n+}\n+\n+function ToggleRow(props: {\n+  label: string;\n+  description: string;\n+  value: boolean;\n+  onChange: (v: boolean) => void;\n+}) {\n+  const { label, description, value, onChange } = props;\n+  return (\n+    <button\n+      type=\"button\"\n+      onClick={() => onChange(!value)}\n+      className=\"flex w-full items-start justify-between gap-4 rounded-2xl border border-white/12 bg-white/5 px-4 py-3 text-left transition hover:bg-white/10\"\n+      aria-pressed={value}\n+    >\n+      <div className=\"min-w-0\">\n+        <div className=\"flex items-center gap-2 text-sm font-semibold text-white/90\">\n+          <span>{label}</span>\n+          {value ? (\n+            <span className=\"inline-flex items-center gap-1 rounded-full border border-emerald-400/30 bg-emerald-400/10 px-2 py-0.5 text-[11px] font-semibold text-emerald-200\">\n+              <IconCheck className=\"h-3.5 w-3.5\" />\n+              On\n+            </span>\n+          ) : (\n+            <span className=\"inline-flex items-center rounded-full border border-white/12 bg-black/20 px-2 py-0.5 text-[11px] font-semibold text-white/60\">\n+              Off\n+            </span>\n+          )}\n+        </div>\n+        <div className=\"mt-1 text-xs leading-relaxed text-white/60\">{description}</div>\n+      </div>\n+\n+      <div\n+        className={\n+          \"mt-0.5 flex h-6 w-11 items-center rounded-full border transition \" +\n+          (value\n+            ? \"border-emerald-400/30 bg-emerald-400/20\"\n+            : \"border-white/12 bg-black/20\")\n+        }\n+        aria-hidden=\"true\"\n+      >\n+        <div\n+          className={\n+            \"h-5 w-5 rounded-full bg-white transition \" +\n+            (value ? \"translate-x-5\" : \"translate-x-0.5\")\n+          }\n+        />\n+      </div>\n+    </button>\n+  );\n+}\n+\n function MapView({\n   apiKey,\n   stops,\n   origin,\n@@ -635,9 +728,9 @@\n       {/* nav */}\n       <header className=\"sticky top-0 z-20 border-b border-white/10 bg-[#070A12]/70 backdrop-blur\">\n         <div className=\"mx-auto flex max-w-6xl items-center justify-between px-4 py-3\">\n           <div className=\"flex items-center gap-2\">\n-            <div className=\"grid h-9 w-9 place-items-center rounded-xl bg-white/10 ring-1 ring-white/15\">\n+            <div className=\"grid h-9 w-9 place-items-center rounded-xl bg-white/10 ring-1 ring-white/15 shadow-[0_0_0_1px_rgba(255,255,255,0.06)]\">\n               <IconSparkle className=\"h-5 w-5\" />\n             </div>\n             <div className=\"leading-tight\">\n               <div className=\"text-sm font-semibold\">{APP_NAME}</div>\n@@ -748,56 +841,42 @@\n                   })}\n                 </div>\n               </div>\n \n-              <div className=\"mt-4 flex flex-col gap-2\">\n-                <button\n-                  type=\"button\"\n-                  onClick={() => setParkOnce((v) => !v)}\n-                  className={\n-                    \"self-start rounded-full px-3 py-1.5 text-sm transition \" +\n-                    (parkOnce\n-                      ? \"bg-white text-black\"\n-                      : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n-                  }\n-                >\n-                  {parkOnce ? \"Park once: ON\" : \"Park once\"}\n-                </button>\n+              <div className=\"mt-4\">\n+                <div className=\"flex items-center justify-between\">\n+                  <div className=\"text-xs text-white/60\">Options</div>\n+                  <div className=\"text-xs text-white/45\">Tap to toggle</div>\n+                </div>\n \n-                <button\n-                  type=\"button\"\n-                  onClick={() => setRiderMode((v) => !v)}\n-                  className={\n-                    \"self-start rounded-full px-3 py-1.5 text-sm transition \" +\n-                    (riderMode\n-                      ? \"bg-white text-black\"\n-                      : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n-                  }\n-                >\n-                  {riderMode ? \"Rider mode: ON\" : \"Rider mode\"}\n-                </button>\n+                <div className=\"mt-2 grid gap-2\">\n+                  <ToggleRow\n+                    label=\"Park once\"\n+                    description=\"Pick a walkable cluster: park near the first stop, then walk between stops.\"\n+                    value={parkOnce}\n+                    onChange={(v) => setParkOnce(v)}\n+                  />\n \n-                <button\n-                  type=\"button\"\n-                  onClick={() => setAddBuffer((v) => !v)}\n-                  className={\n-                    \"self-start rounded-full px-3 py-1.5 text-sm transition \" +\n-                    (addBuffer\n-                      ? \"bg-white text-black\"\n-                      : \"border border-white/15 bg-white/5 text-white/85 hover:bg-white/10\")\n-                  }\n-                >\n-                  {addBuffer ? \"Buffer: +10 min\" : \"Add buffer\"}\n-                </button>\n+                  <ToggleRow\n+                    label=\"Rider mode\"\n+                    description=\"More scenic stops + easy pull-ins. Better for motorcycles and quick loops.\"\n+                    value={riderMode}\n+                    onChange={(v) => setRiderMode(v)}\n+                  />\n \n-                <div className=\"text-xs text-white/55\">\n-                  {parkOnce ? \"Park near the first stop, then walk between stops. \" : \"\"}\n-                  {riderMode ? \"More scenic stops, easier pull-ins, loop-friendly ordering. \" : \"\"}\n-                  {addBuffer ? \"Adds +10 min buffer to each travel leg for parking/traffic.\" : \"\"}\n-                  {!parkOnce && !riderMode && !addBuffer\n-                    ? \"Optional: Park once for walkable clusters, Rider mode for scenic stops, and Buffer for realism.\"\n-                    : null}\n+                  <ToggleRow\n+                    label=\"Add buffer\"\n+                    description=\"Adds +10 minutes to each travel leg for traffic, parking, and delays.\"\n+                    value={addBuffer}\n+                    onChange={(v) => setAddBuffer(v)}\n+                  />\n                 </div>\n+\n+                <div className=\"mt-2 text-xs text-white/55\">\n+                  {parkOnce || riderMode || addBuffer\n+                    ? \"Nice — your itinerary will adapt based on these toggles.\"\n+                    : \"Optional: turn these on to make your plan more realistic and easier to follow.\"}\n+                </div>\n               </div>\n \n               <div className=\"mt-4 rounded-xl border border-white/10 bg-black/20 px-3 py-3\">\n                 <div className=\"flex flex-wrap items-center justify-between gap-3\">\n"
                }
            ],
            "date": 1766786679104,
            "name": "Commit-0",
            "content": "export default function Home() {\n  return (\n    <main className=\"min-h-screen bg-gray-50\">\n      <header className=\"sticky top-0 border-b bg-white\">\n        <div className=\"mx-auto flex max-w-6xl items-center justify-between px-4 py-3\">\n          <div className=\"text-lg font-semibold\">Wander App</div>\n          <div className=\"flex gap-2\">\n            <button className=\"rounded-md border bg-white px-3 py-1.5 text-sm\">\n              Log in\n            </button>\n            <button className=\"rounded-md bg-black px-3 py-1.5 text-sm text-white\">\n              Get started\n            </button>\n          </div>\n        </div>\n      </header>\n\n      <section className=\"mx-auto max-w-6xl px-4 py-10\">\n        <h1 className=\"text-3xl font-bold tracking-tight\">Plan your trip in minutes</h1>\n        <p className=\"mt-2 max-w-2xl text-gray-600\">\n          Tell us where you’re going and we’ll build a day-by-day plan.\n        </p>\n\n        <div className=\"mt-8 rounded-xl border bg-white p-5\">\n          <div className=\"grid gap-4 md:grid-cols-3\">\n            <input\n              className=\"rounded-md border px-3 py-2\"\n              placeholder=\"Destination (e.g., Vancouver)\"\n            />\n            <input\n              className=\"rounded-md border px-3 py-2\"\n              placeholder=\"Days (e.g., 3)\"\n            />\n            <button className=\"rounded-md bg-black px-3 py-2 text-white\">\n              Generate\n            </button>\n          </div>\n        </div>\n\n        <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n          <div className=\"rounded-xl border bg-white p-5\">\n            <div className=\"text-sm font-medium text-gray-500\">Feature</div>\n            <div className=\"mt-1 text-lg font-semibold\">Itineraries</div>\n            <p className=\"mt-2 text-sm text-gray-600\">\n              Create day-by-day plans in a clean dashboard.\n            </p>\n          </div>\n          <div className=\"rounded-xl border bg-white p-5\">\n            <div className=\"text-sm font-medium text-gray-500\">Feature</div>\n            <div className=\"mt-1 text-lg font-semibold\">Saved trips</div>\n            <p className=\"mt-2 text-sm text-gray-600\">\n              Save and revisit plans anytime.\n            </p>\n          </div>\n          <div className=\"rounded-xl border bg-white p-5\">\n            <div className=\"text-sm font-medium text-gray-500\">Feature</div>\n            <div className=\"mt-1 text-lg font-semibold\">Share</div>\n            <p className=\"mt-2 text-sm text-gray-600\">\n              Share a link with friends or family.\n            </p>\n          </div>\n        </div>\n      </section>\n    </main>\n  );\n}\n"
        }
    ]
}